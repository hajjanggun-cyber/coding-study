<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ì½”ë”© ìš©ì–´ ì •ë¦¬</title>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ê´€ê³µì„œ ìŠ¤íƒ€ì¼: ê¹¨ë—í•œ í°ìƒ‰ ë°°ê²½ê³¼ ì‹ ë¢°ê° ìˆëŠ” ë‚¨ìƒ‰ í¬ì¸íŠ¸ */
        body {
            background: #f4f7f9;
            color: #333;
            font-family: 'Nanum Gothic', 'Malgun Gothic', sans-serif;
            padding: 40px 20px;
            margin: 0;
            line-height: 1.6;
            font-size: 16px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #ffffff;
            padding: 30px;
            border-top: 6px solid #003366;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        h2 {
            text-align: center;
            color: #003366;
            margin-bottom: 20px;
            font-size: 32px;
            font-weight: bold;
        }

        /* ì…ë ¥ ì˜ì—­ */
        .input-box {
            border: 1px solid #d1d1d1;
            padding: 20px;
            margin-bottom: 30px;
            background: #fff;
        }

        .input-row {
            display: flex;
            align-items: flex-start;
            /* ìƒë‹¨ ì •ë ¬ë¡œ ë³€ê²½ (textarea í™•ì¥ ëŒ€ì‘) */
            margin-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 15px;
        }

        .label {
            width: 120px;
            font-weight: bold;
            color: #555;
            font-size: 15px;
            padding-top: 10px;
            /* input/textareaì™€ ë†’ì´ ë§ì¶¤ */
            flex-shrink: 0;
            /* ë¼ë²¨ ë„ˆë¹„ ê³ ì • */
        }

        input,
        textarea {
            flex: 1;
            width: 100%;
            /* ë„ˆë¹„ ê½‰ ì±„ìš°ê¸° */
            box-sizing: border-box;
            /* íŒ¨ë”© í¬í•¨ ë„ˆë¹„ ê³„ì‚° */
            padding: 10px;
            border: 1px solid #ccc;
            background: #fafafa;
            font-size: 14px;
        }

        .save-btn {
            background: #003366;
            color: white;
            padding: 12px 0;
            border: none;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            transition: background 0.2s;
        }

        .save-btn.edit-mode {
            background: #f0ad4e;
            /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì˜¤ë Œì§€ìƒ‰ ê³„ì—´ë¡œ ë³€ê²½ */
        }

        .edit-btn {
            background: #5bc0de;
            color: white;
            border: none;
            padding: 4px 10px;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            border-radius: 3px;
        }

        .inline-save-btn,
        .inline-cancel-btn {
            display: block;
            width: 100%;
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            border-radius: 3px;
            margin-bottom: 5px;
        }

        .inline-save-btn {
            background: #5cb85c;
            color: white;
        }

        .inline-cancel-btn {
            background: #999;
            color: white;
        }

        .inline-input,
        .inline-textarea {
            width: 100%;
            padding: 8px;
            font-size: 10pt;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            font-family: inherit;
            scroll-margin-top: 100px;
            /* í¬ì»¤ìŠ¤ ì‹œ ìë™ ìŠ¤í¬ë¡¤ ë°©ì§€ */
            overflow: hidden;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ (ë†’ì´ ìë™ ì¡°ì ˆ ì‚¬ìš©) */
            min-height: 40px;
            white-space: pre-wrap;
            /* ì¤„ë°”ê¿ˆ í—ˆìš© */
            word-break: break-word;
            /* ê¸´ ë‹¨ì–´ ì¤„ë°”ê¿ˆ */
        }

        .inline-input {
            height: auto;
            min-height: 40px;
            line-height: 1.5;
        }

        .edit-cancel-btn {
            background: #666;
            color: white;
            padding: 12px 0;
            border: none;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 5px;
            display: none;
            /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        }

        /* ì»¨íŠ¸ë¡¤ ë° ì •ë ¬ */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            border-bottom: 2px solid #003366;
            padding-bottom: 8px;
        }

        .delete-btn {
            background: #d9534f;
            color: white;
            border: none;
            padding: 6px 15px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
        }

        .move-btn {
            background: #5cb85c;
            color: white;
            border: none;
            padding: 6px 15px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            margin-left: 5px;
        }

        .sort-btn {
            padding: 6px 12px;
            font-size: 13px;
            background: #f8f8f8;
            border: 1px solid #ddd;
            cursor: pointer;
            margin-left: 4px;
        }

        .sort-btn.active {
            background: #003366;
            color: #fff;
            font-weight: bold;
        }

        .select-btn {
            background: #666;
            color: white;
            border: none;
            padding: 6px 15px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            margin-right: 5px;
        }

        /* ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ */
        .card {
            display: flex;
            align-items: flex-start;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            background: #fff;
            text-align: left;
        }

        .chk-box {
            margin-right: 12px;
            margin-top: 5px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            flex: none;
        }

        .card-term {
            width: 200px;
            font-weight: bold;
            color: #003366;
            font-size: 10pt;
            margin-right: 20px;
            flex-shrink: 0;
            word-break: keep-all;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì œëª© ì˜ì—­ì´ í™•ì¥ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì • */
        .card.editing .card-term {
            width: auto;
            min-width: 200px;
            max-width: 100%;
            flex-shrink: 1;
        }

        /* ì œëª© textareaê°€ ë¶€ëª¨ ë„ˆë¹„ë¥¼ ë”°ë¥´ë„ë¡ ì„¤ì • */
        .card-term .inline-textarea {
            width: 100% !important;
            box-sizing: border-box;
            min-width: 200px;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì¹´ë“œ ì»¨í…íŠ¸ë¥¼ ì„¸ë¡œ ë°°ì¹˜ë¡œ ë³€ê²½ */
        .card.editing .card-content {
            display: flex;
            flex-direction: column;
            /* ì œëª©ê³¼ ë‚´ìš©ì„ ì„¸ë¡œë¡œ ë°°ì¹˜ */
            align-items: stretch;
            /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
            width: 100%;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ë‚´ìš© textareaê°€ ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
        .card.editing .card-desc,
        .card.editing .card-desc .inline-textarea {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ê°•ì˜ì •ë¦¬/ì‹¤ì „ê³¼ì •ì˜ wrapper divë„ ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
        .card.editing .card-content>div {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
            flex: 1;
        }

        /* ëª¨ë“  inline-textareaê°€ ë¶€ëª¨ ë„ˆë¹„ë¥¼ ì™„ì „íˆ ì±„ìš°ë„ë¡ ê°•ì œ */
        .card.editing .inline-textarea {
            width: 100% !important;
            max-width: 100% !important;
            min-width: 100% !important;
            box-sizing: border-box !important;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì œëª© ì˜ì—­ë„ ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
        .card.editing .card-term {
            width: 100% !important;
            max-width: 100% !important;
            margin-right: 0;
            margin-bottom: 10px;
            /* ì œëª©ê³¼ ë‚´ìš© ì‚¬ì´ ê°„ê²© */
        }

        .card-desc {
            flex: 1;
            color: #444;
            font-size: 10pt;
            white-space: pre-wrap;
            line-height: 1.5;
        }

        /* ì ‘ê¸°/í¼ì¹˜ê¸° ê¸°ëŠ¥ */
        .card-desc.collapsed {
            max-height: 15em;
            /* 10ì¤„ ë†’ì´ (1.5 * 10 = 15em) */
            overflow: hidden;
            position: relative;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: #003366;
            cursor: pointer;
            font-size: 9pt;
            padding: 2px 5px;
            margin-left: 5px;
            text-decoration: underline;
            font-weight: bold;
        }

        .toggle-btn:hover {
            color: #0056b3;
        }

        /* ë¡œë”© ì¸ë””ì¼€ì´í„° */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #003366;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            margin-top: 20px;
            color: #003366;
            font-size: 16px;
            font-weight: bold;
        }

        /* ì¹´í…Œê³ ë¦¬ ì´ë™ ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 90%;
        }

        .modal-title {
            font-size: 18px;
            font-weight: bold;
            color: #003366;
            margin-bottom: 20px;
            text-align: center;
        }

        .category-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .category-btn {
            background: #f0f0f0;
            border: 2px solid #ddd;
            padding: 15px;
            font-size: 14px;
            font-weight: bold;
            color: #003366;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.2s;
        }

        .category-btn:hover {
            background: #003366;
            color: white;
            border-color: #003366;
        }

        .modal-close {
            margin-top: 15px;
            background: #999;
            color: white;
            border: none;
            padding: 10px;
            width: 100%;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
        }

        .modal-close:hover {
            background: #666;
        }

        /* ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ëª¨ë‹¬ (ë³´ì•ˆ) */
        .password-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #003366;
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .password-modal.hidden {
            display: none;
        }

        .password-box {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
            width: 300px;
        }

        .password-box h3 {
            margin-top: 0;
            color: #003366;
            margin-bottom: 20px;
        }

        .password-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 15px;
            text-align: center;
        }

        .password-submit {
            width: 100%;
            padding: 12px;
            background: #003366;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }

        .password-submit:hover {
            background: #004080;
        }

        /* í•˜ì´í¼ë§í¬ ìŠ¤íƒ€ì¼ */
        .card-desc a {
            color: #003366 !important;
            text-decoration: underline !important;
            font-weight: bold;
        }

        .card-desc a:hover {
            color: #0056b3 !important;
        }

        /* í…ìŠ¤íŠ¸ ë˜í¼ (PC ê¸°ë³¸) */
        .card-content {
            display: flex;
            flex: 1;
            align-items: flex-start;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            h2 {
                font-size: 24px;
                margin-bottom: 20px;
            }

            /* ì…ë ¥ í¼ ìˆ˜ì§ ë°°ì¹˜ */
            .input-row {
                flex-direction: column;
                align-items: stretch;
            }

            .label {
                width: 100%;
                margin-bottom: 8px;
            }

            /* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ ëª¨ë°”ì¼ ìµœì í™” */
            .controls {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .controls>div {
                display: flex;
                justify-content: space-between;
                width: 100%;
            }

            .select-btn,
            .delete-btn,
            .move-btn {
                flex: 1;
                margin: 0 2px;
                padding: 8px 0;
                /* ì¢Œìš° íŒ¨ë”© ì œê±° í›„ ì¤‘ì•™ ì •ë ¬ */
                text-align: center;
                font-size: 13px;
                white-space: nowrap;
            }

            .select-btn {
                margin-left: 0;
            }

            .move-btn {
                margin-right: 0;
            }

            .sort-btn {
                flex: 1;
                text-align: center;
                margin: 0 2px;
            }

            /* ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ ìˆ˜ì§ ë°°ì¹˜ */
            .card-content {
                display: block;
            }

            .card-term {
                width: 100%;
                margin-right: 0;
                margin-bottom: 6px;
                border-bottom: 1px dashed #eee;
                padding-bottom: 4px;
            }

            .card-desc {
                width: 100%;
            }
        }

        /* íƒ­ ìŠ¤íƒ€ì¼ - PCì—ì„œ í•œ ì¤„ ê½‰ ì°¨ê²Œ */
        .tabs {
            display: grid;
            grid-auto-flow: column;
            grid-auto-columns: minmax(0, 1fr);
            /* ì¤‘ìš”: ìµœì†Œ í¬ê¸° 0ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ë¬´ì¡°ê±´ ê· ë“± ë¶„í•  */
            gap: 2px;
            margin-bottom: 0;
            border-bottom: 2px solid #003366;
            padding-bottom: 0px;
        }



        .tab {
            width: 100%;
            /* ì…€ ê½‰ ì±„ìš°ê¸° */
            padding: 12px 2px;
            /* ì¢Œìš° ì—¬ë°± ìµœì†Œí™” */
            text-align: center;
            white-space: nowrap;
            cursor: pointer;
            background: #f1f3f5;
            border: 1px solid #ddd;
            border-bottom: none;
            font-weight: bold;
            color: #555;
            border-radius: 5px 5px 0 0;
            /* ìœ„ìª½ë§Œ ë‘¥ê¸€ê²Œ */
            transition: all 0.2s;
            font-size: 13.5px;
            overflow: hidden;
            text-overflow: ellipsis;
            /* ê¸€ì ë„˜ì¹˜ë©´ ë§ì¤„ì„ */
            -webkit-overflow-scrolling: touch;
            /* ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ ë¶€ë“œëŸ½ê²Œ */
        }

        .order-btn {
            background: #fff;
            border: 1px solid #ccc;
            padding: 6px 8px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            margin-right: 2px;
            transition: all 0.2s;
        }

        .order-btn:hover {
            background: #e9ecef;
        }

        .tabs::-webkit-scrollbar {
            display: none;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
        }

        .tab:hover {
            background: #e0e4e8;
            color: #003366;
        }

        .tab.active {
            background: #003366;
            color: white;
            border-color: #003366;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .tabs {
                display: flex;
                /* ëª¨ë°”ì¼ì€ Flexë¡œ ì „í™˜ */
                flex-wrap: wrap;
                /* ëª¨ë°”ì¼ì—ì„œëŠ” ì¤„ë°”ê¿ˆ í—ˆìš© */
                overflow-x: visible;
                gap: 4px;
                padding-bottom: 5px;
            }

            .tab {
                flex: 1 1 calc(33% - 4px);
                /* í•œ ì¤„ì— 3ê°œì”© */
                font-size: 12px;
                padding: 10px 5px;
                border-radius: 5px;
                border: 1px solid #ddd;
            }
        }

        .input-box {
            border-top: none;
            /* íƒ­ê³¼ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²° */
        }
    </style>
</head>

<body>
    <!-- ë¹„ë°€ë²ˆí˜¸ ì ê¸ˆ í™”ë©´ -->
    <div id="passwordModal" class="password-modal">
        <div class="password-box">
            <h3>ğŸ”’ ë³´ì•ˆ ì ‘ì†</h3>
            <p style="font-size:13px; color:#666; margin-bottom:20px;">ì„¤ì •í•˜ì‹  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            <input type="password" id="passwordInput" class="password-input" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
                onkeypress="handleEnter(event)">
            <button class="password-submit" onclick="submitPassword()">ì ‘ì†í•˜ê¸°</button>
        </div>
    </div>
    <!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>

    <div class="container">
        <h2>ì½”ë”© ìš©ì–´ ì •ë¦¬</h2>

        <div class="tabs">
            <div class="tab Active" id="tab-coding" onclick="switchTab('Coding')">Codingìš©ì–´</div>
            <div class="tab" id="tab-prompt" onclick="switchTab('Prompt')">í”„ë¡¬í”„íŠ¸</div>
            <div class="tab" id="tab-url" onclick="switchTab('URL')">ì°¸ê³ URL</div>
            <div class="tab" id="tab-ideas" onclick="switchTab('Ideas')">ì•„ì´ë””ì–´</div>
            <div class="tab" id="tab-workprocess" onclick="switchTab('WorkProcess')">ì‹¤ì „ê³¼ì •</div>
            <div class="tab" id="tab-jungri" onclick="switchTab('Jungri')">ê°•ì˜ì •ë¦¬</div>
            <div class="tab" id="tab-customer" onclick="switchTab('Customer')">ì†ë‹˜ë‚´ìš©</div>
            <div class="tab" id="tab-visit" onclick="switchTab('Visit')">ë°©ë¬¸ì˜ˆì •</div>
            <div class="tab" id="tab-itemdetail" onclick="switchTab('ItemDetail')">ë¬¼ê±´ì„¸ë¶€</div>
            <div class="tab" id="tab-private" onclick="switchTab('Private')">ê°œì¸ìë£Œ</div>
        </div>

        <div class="input-box">
            <div class="input-row">
                <div class="label">ìš©ì–´</div>
                <input type="text" id="term" placeholder="ìš©ì–´">
            </div>

            <!-- ì¹´í…Œê³ ë¦¬ ì´ë™ ëª¨ë‹¬ -->
            <div id="moveModal" class="modal">
                <div class="modal-content">
                    <div class="modal-title">ì´ë™í•  ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
                    <div class="category-buttons" id="categoryButtons">
                        <!-- ë²„íŠ¼ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                    <button class="modal-close" onclick="closeMoveModal()">ì·¨ì†Œ</button>
                </div>
            </div>
            <div class="input-row" style="border:none;">
                <div class="label">ìš©ì–´ ì„¤ëª…</div>
                <textarea id="description" rows="3"></textarea>
            </div>
            <button id="btn-save" class="save-btn" onclick="saveData()">ë°ì´í„° ë“±ë¡</button>
            <button id="btn-cancel" class="edit-cancel-btn" onclick="cancelEdit()">ìˆ˜ì • ì·¨ì†Œ</button>
        </div>

        <div class="controls">
            <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 5px;">
                <button class="select-btn" onclick="toggleSelectAll()">ì „ì²´ ì„ íƒ</button>
                <div style="margin-left:auto; display:flex; gap:2px;">
                    <button class="order-btn" onclick="reorderItem('top')" title="ë§¨ ìœ„ë¡œ">â«</button>
                    <button class="order-btn" onclick="reorderItem('up')" title="ìœ„ë¡œ">ğŸ”¼</button>
                    <button class="order-btn" onclick="reorderItem('down')" title="ì•„ë˜ë¡œ">ğŸ”½</button>
                    <button class="order-btn" onclick="reorderItem('bottom')" title="ë§¨ ì•„ë˜ë¡œ">â¬</button>
                </div>
                <button class="delete-btn" onclick="deleteSelected()">ì„ íƒ ì‚­ì œ</button>
                <button class="move-btn" onclick="moveSelected()">ì„ íƒ ì´ë™</button>
            </div>
            <div style="margin-top: 5px;">
                <button class="sort-btn" data-sort="custom" onclick="changeSort('custom')">ì…ë ¥ìˆœ</button>
                <button class="sort-btn active" data-sort="newest" onclick="changeSort('newest')">ìµœì‹ ìˆœ</button>
                <button class="sort-btn" data-sort="alphabet" onclick="changeSort('alphabet')">ê°€ë‚˜ë‹¤ìˆœ</button>
            </div>
        </div>

        <div id="list-container">
        </div>

        <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤ (ìƒë‹¨ê³¼ ë™ì¼ ê¸°ëŠ¥) -->
        <div class="controls" style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 15px;">
            <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 5px;">
                <button class="select-btn" onclick="toggleSelectAll()">ì „ì²´ ì„ íƒ</button>
                <div style="margin-left:auto; display:flex; gap:2px;">
                    <button class="order-btn" onclick="reorderItem('top')" title="ë§¨ ìœ„ë¡œ">â«</button>
                    <button class="order-btn" onclick="reorderItem('up')" title="ìœ„ë¡œ">ğŸ”¼</button>
                    <button class="order-btn" onclick="reorderItem('down')" title="ì•„ë˜ë¡œ">ğŸ”½</button>
                    <button class="order-btn" onclick="reorderItem('bottom')" title="ë§¨ ì•„ë˜ë¡œ">â¬</button>
                </div>
                <button class="delete-btn" onclick="deleteSelected()">ì„ íƒ ì‚­ì œ</button>
                <button class="move-btn" onclick="moveSelected()">ì„ íƒ ì´ë™</button>
            </div>
            <div style="margin-top: 5px;">
                <button class="sort-btn" data-sort="custom" onclick="changeSort('custom')">ì…ë ¥ìˆœ</button>
                <button class="sort-btn active" data-sort="newest" onclick="changeSort('newest')">ìµœì‹ ìˆœ</button>
                <button class="sort-btn" data-sort="alphabet" onclick="changeSort('alphabet')">ê°€ë‚˜ë‹¤ìˆœ</button>
            </div>
        </div>
    </div>

    <script>
        // êµ¬ê¸€ ì›¹ ì•± URL (ìµœì¢… ë°°í¬ ë²„ì „)
        // êµ¬ê¸€ ì›¹ ì•± URL (ìµœì¢… ë°°í¬ ë²„ì „)
        const API_URL = "https://script.google.com/macros/s/AKfycbzopNXwR0HQNFGi7TBZMxCvcZu0SXBJHKBaaM9UKTR_tVbHq-NCaDShxeCcpy-Ez5ZdwQ/exec";

        let currentSort = 'newest';
        let currentSheet = 'Coding'; // í˜„ì¬ ì„ íƒëœ ì‹œíŠ¸ì´ë¦„ (íƒ­ ìƒíƒœ)
        let cachedData = null; // ëª¨ë“  ì‹œíŠ¸ ë°ì´í„°ë¥¼ ì €ì¥í•  ë³€ìˆ˜
        let userPassword = ''; // ğŸ”’ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ì €ì¥

        // URLê³¼ ì „í™”ë²ˆí˜¸ë¥¼ í•˜ì´í¼ë§í¬ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        function linkify(text) {
            if (!text) return "";
            let result = text.toString();

            // 1. URL ë³€í™˜ (ê¸°ì¡´ ë¡œì§)
            const urlPattern = /((?:https?|ftp):\/\/[^\s]+|\b[a-z0-9.-]+\.(?:com|net|org|kr|io|dev|pages\.dev|me|info)(?:\/[^\s]*)?\b)/gim;
            result = result.replace(urlPattern, function (url) {
                // ì´ë¯¸ ë§í¬ íƒœê·¸ì˜ ì¼ë¶€ì¸ ê²½ìš°(ì˜ˆ: href="...") ê±´ë„ˆë›°ê¸° (ê°„ë‹¨í•œ ì²´í¬)
                if (url.startsWith('href="')) return url;

                let href = url;
                if (!/^https?:\/\//i.test(url)) {
                    href = 'https://' + url;
                }
                return `<a href="${href}" target="_blank" rel="noopener noreferrer">${url}</a>`;
            });

            // 2. ì „í™”ë²ˆí˜¸ ë³€í™˜ (010, 02 ë“±ìœ¼ë¡œ ì‹œì‘í•˜ê³  í•˜ì´í”ˆ í¬í•¨)
            // ì˜ˆ: 010-1234-5678, 02-123-4567
            const phonePattern = /\b(0\d{1,2})-(\d{3,4})-(\d{4})\b/g;
            result = result.replace(phonePattern, function (match, p1, p2, p3) {
                // ì´ë¯¸ URL ë³€í™˜ ê³¼ì •ì—ì„œ ë§í¬ì˜ ì¼ë¶€ê°€ ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì€ ë§¤ìš° ë‚®ì§€ë§Œ(ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ë„ë©”ì¸ì— í¬í•¨ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ),
                // ì•ˆì „ì„ ìœ„í•´ ì²´í¬ ë¡œì§ì„ ë„£ì„ ìˆ˜ë„ ìˆìŒ. í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” íŒ¨í„´ì´ íŠ¹ì´í•˜ì—¬ ë°”ë¡œ ë³€í™˜.
                return `<a href="tel:${p1}${p2}${p3}" class="phone-link" style="color:#003366; text-decoration:underline;">${match}</a>`;
            });

            return result;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¹„ë°€ë²ˆí˜¸ ë¨¼ì € ë¬¼ì–´ë³´ê¸°
        window.onload = function () {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸ê°€ ìˆëŠ”ì§€ í™•ì¸ (ì„ íƒ ì‚¬í•­)
            const savedPw = localStorage.getItem('app_password');
            if (savedPw) {
                userPassword = savedPw;
                document.getElementById('passwordModal').classList.add('hidden');
                showLoading();
                fetchCurrentTabData();
            } else {
                document.getElementById('passwordInput').focus();
            }
        };

        // ë¹„ë°€ë²ˆí˜¸ ì œì¶œ ì²˜ë¦¬
        function submitPassword() {
            const input = document.getElementById('passwordInput');
            userPassword = input.value;

            if (!userPassword) {
                alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë¹„ë°€ë²ˆí˜¸ ì €ì¥ (í¸ì˜ì„±)
            localStorage.setItem('app_password', userPassword);

            // ëª¨ë‹¬ ìˆ¨ê¸°ê³  ë°ì´í„° ë¡œë“œ ì‹œì‘
            document.getElementById('passwordModal').classList.add('hidden');
            showLoading();
            fetchCurrentTabData();
        }

        // ì—”í„°í‚¤ ì²˜ë¦¬
        function handleEnter(e) {
            if (e.key === 'Enter') submitPassword();
        }

        // ë˜‘ë˜‘í•œ ë¡œë”© ì•Œë¦¼ì°½ (íƒ€ì´ë¨¸ ì ìš©)
        let loadingTimer1, loadingTimer2;

        function showLoading() {
            const overlay = document.getElementById('loadingOverlay');
            let msg = document.getElementById('loadingMessage');

            // ë©”ì‹œì§€ ìš”ì†Œ ë™ì  ìƒì„± (HTML ìˆ˜ì • ë¶ˆí•„ìš”)
            if (!msg) {
                msg = document.createElement('p');
                msg.id = 'loadingMessage';
                msg.style.cssText = 'margin-top: 20px; font-size: 1rem; font-weight: 500; min-height: 1.5em; text-align: center; color: #fff; transition: opacity 0.5s; opacity: 0; text-shadow: 0 1px 3px rgba(0,0,0,0.3);';
                overlay.appendChild(msg);
            }

            // ì´ˆê¸°í™”
            msg.textContent = '';
            msg.style.opacity = '0';
            msg.style.color = '#fff';
            overlay.classList.remove('hidden');

            // 3ì´ˆ í›„: ì•ˆì‹¬ ë©”ì‹œì§€
            loadingTimer1 = setTimeout(() => {
                msg.textContent = 'â˜ï¸ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê³  ìˆì–´ìš”...';
                msg.style.opacity = '1';
            }, 3000);

            // 8ì´ˆ í›„: ì§€ì—° ì•ˆë‚´ ë©”ì‹œì§€
            loadingTimer2 = setTimeout(() => {
                msg.textContent = 'ğŸ¢ ì„œë²„ê°€ ì¡°ê¸ˆ ë°”ì˜ë„¤ìš”, ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...';
                msg.style.color = '#ffeb3b'; // ë…¸ë€ìƒ‰ìœ¼ë¡œ ì£¼ì˜ í™˜ê¸°
            }, 8000);
        }

        function hideLoading() {
            // íƒ€ì´ë¨¸ ì·¨ì†Œ
            clearTimeout(loadingTimer1);
            clearTimeout(loadingTimer2);

            const overlay = document.getElementById('loadingOverlay');
            if (overlay) overlay.classList.add('hidden');

            const msg = document.getElementById('loadingMessage');
            if (msg) {
                msg.textContent = '';
                msg.style.opacity = '0';
            }
        }

        // í˜„ì¬ íƒ­ë§Œ ë¶ˆëŸ¬ì˜¤ê¸° (ì´ˆê¸° ë¡œë”© ì†ë„ ê°œì„ )
        function fetchCurrentTabData() {
            // ë¹„ë°€ë²ˆí˜¸ í¬í•¨í•˜ì—¬ ìš”ì²­
            const url = `${API_URL}?action=load&sheetName=${currentSheet}&t=${new Date().getTime()}&password=${encodeURIComponent(userPassword)}`;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    // ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜ ì²´í¬
                    if (data.status === 'error' && data.message.includes('ë¹„ë°€ë²ˆí˜¸')) {
                        alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
                        localStorage.removeItem('app_password'); // ì˜ëª»ëœ ë¹„ë²ˆ ì‚­ì œ
                        document.getElementById('passwordModal').classList.remove('hidden');
                        document.getElementById('loadingOverlay').classList.add('hidden');
                        return;
                    }

                    if (!cachedData) cachedData = {};
                    cachedData[currentSheet] = data;
                    cachedData[currentSheet] = data;
                    updateInputUI(currentSheet); // ì´ˆê¸° ë¡œë“œ ì‹œ UI ì„¤ì • (textarea ë†’ì´ ë“±) ì ìš©
                    renderCurrentSheet();
                    hideLoading();
                })
                .catch(err => {
                    console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
                    hideLoading();
                    alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });
        }

        // ì „ ì‹œíŠ¸ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ (ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”ìš©)
        function fetchAllData(callback) {
            // ë¹„ë°€ë²ˆí˜¸ í¬í•¨
            const url = `${API_URL}?action=loadAll&t=${new Date().getTime()}&password=${encodeURIComponent(userPassword)}`;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    if (data && data.status === 'error') {
                        if (data.message.includes('ë¹„ë°€ë²ˆí˜¸')) {
                            console.error('ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™” ì‹¤íŒ¨: ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜');
                            return;
                        }
                        throw new Error(data.message || 'ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜');
                    }

                    // loadAll ê²°ê³¼(ê°ì²´ í˜•íƒœ)ì¸ì§€ í™•ì¸
                    if (!data || typeof data !== 'object' || Array.isArray(data)) {
                        throw new Error('ì„œë²„ ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. (GASë¥¼ ìµœì‹  ì½”ë“œë¡œ ìˆ˜ì •í•˜ê³  [ìƒˆ ë°°í¬] í•˜ì…¨ë‚˜ìš”?)');
                    }

                    cachedData = data;
                    if (callback) callback();
                    else renderCurrentSheet();
                })
                .catch(err => {
                    console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
                    const container = document.getElementById('list-container'); // container ë³€ìˆ˜ ì„ ì–¸
                    if (container) {
                        container.innerHTML = `
                            <div style="text-align:center; color:#d9534f; padding:40px;">
                                <p><strong>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</strong></p>
                                <p style="font-size:13px; color:#666;">ì›ì¸: ${err.message}</p>
                                <p style="font-size:13px; color:#003366; cursor:pointer; text-decoration:underline;" onclick="fetchAllData()">[ë‹¤ì‹œ ì‹œë„í•˜ê¸°]</p>
                            </div>
                        `;
                    }
                });
        }

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchTab(sheetName) {
            currentSheet = sheetName;

            // íƒ­ í™œì„±í™” í‘œì‹œ
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(`tab-${sheetName.toLowerCase()}`).classList.add('active');

            // í•´ë‹¹ íƒ­ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¡œë”©
            if (!cachedData || !cachedData[sheetName]) {
                showLoading();
                fetchCurrentTabData();
            } else {
                renderCurrentSheet();
            }

            // UI ì—…ë°ì´íŠ¸ (ì…ë ¥ì°½ ë¼ë²¨, placeholder, textarea ë†’ì´ ë“±)
            updateInputUI(sheetName);
        }

        // ì…ë ¥ í¼ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (íƒ­ ì „í™˜ ë° ì´ˆê¸° ë¡œë“œ ì‹œ ì‚¬ìš©)
        function updateInputUI(sheetName) {
            const termInput = document.getElementById('term');
            const termLabel = document.querySelector('.input-row .label');
            const descLabel = document.querySelectorAll('.input-row .label')[1];
            const descInput = document.getElementById('description');

            // ê¸°ë³¸ ì„¸ë¡œ ê¸¸ì´ (10ì¤„)ë¡œ ì´ˆê¸°í™” - Coding, Prompt, URL, Ideas íƒ­ì— ì ìš©ë¨
            descInput.rows = 10;

            // íƒ­ë³„ UI ì„¤ì •
            if (sheetName === 'Coding') {
                termInput.placeholder = 'ìš©ì–´ (ì˜ˆ: API, Variable)';
                termLabel.textContent = 'ìš©ì–´';
                descLabel.textContent = 'ìš©ì–´ ì„¤ëª…';
            } else if (sheetName === 'Prompt') {
                termInput.placeholder = 'í”„ë¡¬í”„íŠ¸ (ì˜ˆ: ì‹œë¥¼ ì¨ì¤˜, ì½”ë“œ ë¦¬ë·°í•´ì¤˜)';
                termLabel.textContent = 'í”„ë¡¬í”„íŠ¸';
                descLabel.textContent = 'ìƒì„¸ ì„¤ëª…';
            } else if (sheetName === 'URL') {
                termInput.placeholder = 'ì°¸ê³  ì œëª© (ì˜ˆ: ìœ ìš©í•œ ì‚¬ì´íŠ¸)';
                termLabel.textContent = 'ì°¸ê³  ì œëª©';
                descLabel.textContent = 'ì°¸ê³  URL/ì„¤ëª…';
            } else if (sheetName === 'Ideas') {
                termInput.placeholder = 'ì•„ì´ë””ì–´ ì œëª© (ì˜ˆ: ì•± ê¸°íš ì•ˆ)';
                termLabel.textContent = 'ì•„ì´ë””ì–´ ì œëª©';
                descLabel.textContent = 'ì•„ì´ë””ì–´ ìƒì„¸ ë‚´ìš©';
            } else if (sheetName === 'Jungri') {
                termInput.placeholder = 'ê°•ì˜ ì œëª© (ì˜ˆ: React ê¸°ì´ˆ ê°•ì˜)';
                termLabel.textContent = 'ê°•ì˜ ì œëª©';
                descLabel.textContent = 'ê°•ì˜ ì •ë¦¬';
                descInput.rows = 30; // ê°•ì˜ ì •ë¦¬ë„ ê¸¸ê²Œ
            } else if (sheetName === 'WorkProcess') {
                termInput.placeholder = 'ì‹¤ì „ ì œëª© (ì˜ˆ: í”„ë¡œì íŠ¸ ì§„í–‰ ê³¼ì •)';
                termLabel.textContent = 'ì‹¤ì „ ì œëª©';
                descLabel.textContent = 'ì‹¤ì „ ê³¼ì •';
                descInput.rows = 30; // ì‹¤ì „ ê³¼ì •ë„ ê¸¸ê²Œ
            } else if (sheetName === 'Customer') {
                termInput.placeholder = 'ì†ë‹˜ ì œëª© (ì˜ˆ: í™ê¸¸ë™)';
                termLabel.textContent = 'ì†ë‹˜ ì œëª©';
                descLabel.textContent = 'ì†ë‹˜ ë‚´ìš©';
                descInput.rows = 30; // ì†ë‹˜ ë‚´ìš©ë„ ê¸¸ê²Œ
            } else if (sheetName === 'Visit') {
                termInput.placeholder = 'ë°©ë¬¸ ì¼ì • (ì˜ˆ: 2024-01-01)';
                termLabel.textContent = 'ë°©ë¬¸ ì¼ì •';
                descLabel.textContent = 'ë°©ë¬¸ ë‚´ìš©';
                descInput.rows = 30; // ë°©ë¬¸ ë‚´ìš©ë„ ê¸¸ê²Œ
            } else if (sheetName === 'ItemDetail') {
                termInput.placeholder = 'ë¬¼ê±´ ì´ë¦„ (ì˜ˆ: ëƒ‰ì¥ê³ )';
                termLabel.textContent = 'ë¬¼ê±´ ì´ë¦„';
                descLabel.textContent = 'ì„¸ë¶€ ì‚¬í•­';
                descInput.rows = 30; // ë¬¼ê±´ ì„¸ë¶€ ì‚¬í•­ë„ ê¸¸ê²Œ
            } else if (sheetName === 'Private') {
                termInput.placeholder = 'ìë£Œ ì œëª© (ì˜ˆ: ë¹„ë°€ë²ˆí˜¸)';
                termLabel.textContent = 'ìë£Œ ì œëª©';
                descLabel.textContent = 'ìë£Œ ë‚´ìš©';
                descInput.rows = 30; // ê°œì¸ ìë£Œë„ ê¸¸ê²Œ
            }

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('term').value = '';
            document.getElementById('description').value = '';
        }

        // ì¸ë¼ì¸ ìˆ˜ì • ëª¨ë“œ í† ê¸€
        function toggleInlineEdit(id) {
            const card = document.querySelector(`.card[data-id="${id}"]`);
            const isEditing = card.classList.contains('editing');

            // ë‹¤ë¥¸ ì¹´ë“œê°€ ì´ë¯¸ ìˆ˜ì • ì¤‘ì¸ì§€ í™•ì¸ (ìì‹ ì´ ìˆ˜ì • ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ì²´í¬)
            if (!isEditing) {
                const otherEditingCard = document.querySelector('.card.editing');
                if (otherEditingCard) {
                    alert('ì´ë¯¸ ìˆ˜ì • ì¤‘ì¸ í•­ëª©ì´ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € ì™„ë£Œí•˜ê±°ë‚˜ ì·¨ì†Œí•´ì£¼ì„¸ìš”.');
                    otherEditingCard.scrollIntoView({ behavior: 'smooth', block: 'center' }); // ìˆ˜ì • ì¤‘ì¸ ê³³ìœ¼ë¡œ ì´ë™
                    otherEditingCard.classList.add('highlight-pulse'); // ê°•ì¡° íš¨ê³¼ (CSS í•„ìš”í•˜ì§€ë§Œ ì—†ì–´ë„ ë¬´ë°©)
                    setTimeout(() => otherEditingCard.classList.remove('highlight-pulse'), 1000);
                    return;
                }
            }

            if (isEditing) {
                // ìˆ˜ì • ì·¨ì†Œ (ìºì‹œì—ì„œ ì›ë³¸ ë°ì´í„° ë³µì›)
                const id = card.getAttribute('data-id');
                if (cachedData && cachedData[currentSheet]) {
                    const item = cachedData[currentSheet].find(item => String(item.id) === String(id));
                    if (item) {
                        const termDiv = card.querySelector('.card-term');
                        const descDiv = card.querySelector('.card-desc');
                        termDiv.textContent = item.term;

                        const useCollapse = true; // ëª¨ë“  ì‹œíŠ¸ í—ˆìš©
                        const description = linkify(item.description);
                        const descriptionText = String(item.description || '');
                        const lines = descriptionText.split('\n');
                        const isLongContent = lines.length > 10; // 10ì¤„ ì´ˆê³¼ ì‹œì—ë§Œ ë²„íŠ¼ í‘œì‹œ

                        if (useCollapse && isLongContent) {
                            // ë¶€ëª¨ div ì°¾ê¸°
                            const parentDiv = descDiv.parentElement;
                            parentDiv.innerHTML = `
                                <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                                <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                            `;
                        } else {
                            descDiv.innerHTML = description;
                        }

                        const actionsDiv = card.querySelector('.card-actions');
                        actionsDiv.innerHTML = `<button class="edit-btn" onclick="toggleInlineEdit('${id}')">ìˆ˜ì •</button>`;
                        card.classList.remove('editing');
                    }
                }
            } else {
                // ë‹¤ë¥¸ ëª¨ë“  ìˆ˜ì • ëª¨ë“œ í•´ì œ (ë™ì‹œ ìˆ˜ì • ë°©ì§€)
                document.querySelectorAll('.card.editing').forEach(c => c.classList.remove('editing'));

                // ìˆ˜ì • ëª¨ë“œ í•´ì œ ì‹œì—ëŠ” ìºì‹œëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì‹œ ê·¸ë¦¬ëŠ” ê²ƒì´ ì•ˆì „í•¨
                // í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœ í† ê¸€ì´ë¯€ë¡œ ìš”ì†Œë¥¼ ì°¾ëŠ”ë° ì§‘ì¤‘

                // 1. ë§Œì•½ ì´ë¯¸ ìˆ˜ì • ì¤‘ì´ì—ˆë‹¤ë©´ (ì·¨ì†Œ ë²„íŠ¼ í´ë¦­), ì›ë˜ ë·°ë¡œ ë³µêµ¬í•´ì•¼ í•¨
                // ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ í•´ë‹¹ ì¹´ë“œë¥¼ ìºì‹œ ë°ì´í„°ë¡œ ë‹¤ì‹œ ë Œë”ë§í•˜ëŠ” ê²ƒ
                if (card.classList.contains('editing')) {
                    const item = cachedData[currentSheet].find(i => String(i.id) === String(id));
                    if (item) {
                        // ì¹´ë“œ ë‚´ìš© ì „ì²´ë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ê¸° (ì ‘ê¸°/í¼ì¹˜ê¸° ìƒíƒœ ì´ˆê¸°í™”ë¨)
                        // ê¸°ì¡´ ì¹´ë“œ êµì²´ ë°©ì‹
                        const tempContainer = document.createElement('div');

                        // ì¹´ë“œ ë‚´ìš© ì¬êµ¬ì„± (renderCurrentSheet ë¡œì§ ì¼ë¶€ ì¬ì‚¬ìš©)
                        const isLecture = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);
                        const description = linkify(item.description);
                        const descriptionText = String(item.description || '');
                        const lines = descriptionText.split('\n');
                        const isLongContent = lines.length > 1;

                        let descHtml = '';
                        if (isLecture && isLongContent) {
                            descHtml = `
                                <div>
                                    <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                                    <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                                </div>
                            `;
                        } else {
                            descHtml = `<div class="card-desc">${description}</div>`;
                        }

                        card.innerHTML = `
                            <input type="checkbox" class="chk-box" data-id="${item.id}">
                            <div class="card-content">
                                <div class="card-term">${item.term}</div>
                                ${descHtml}
                            </div>
                            <div class="card-actions">
                                <button class="edit-btn" onclick="toggleInlineEdit('${item.id}')">ìˆ˜ì •</button>
                            </div>`;

                        card.classList.remove('editing');
                        return; // í•¨ìˆ˜ ì¢…ë£Œ
                    }
                }

                // --- ìˆ˜ì • ëª¨ë“œ ì§„ì… ë¡œì§ ---

                const termDiv = card.querySelector('.card-term');
                let descDiv = card.querySelector('.card-desc');
                const currentTerm = termDiv.textContent;

                // ê°•ì˜ì •ë¦¬/ì‹¤ì „ê³¼ì •ì˜ ê²½ìš° descDivê°€ ë¶€ëª¨ div ì•ˆì— ìˆì„ ìˆ˜ ìˆìŒ
                let descParent = null;
                let currentDescText = '';
                if (!descDiv) {
                    // descDivë¥¼ ì°¾ì§€ ëª»í•œ ê²½ìš°, card-content ë‚´ë¶€ì—ì„œ ì°¾ê¸°
                    const cardContent = card.querySelector('.card-content');
                    descDiv = cardContent.querySelector('.card-desc');
                    if (descDiv) {
                        descParent = descDiv.parentElement;
                        currentDescText = descDiv.textContent; // í…ìŠ¤íŠ¸ ì €ì¥
                    }
                } else {
                    // descDivëŠ” ìˆì§€ë§Œ ë¶€ëª¨ê°€ card-contentê°€ ì•„ë‹Œ ê²½ìš° (wrapper ì¡´ì¬)
                    if (descDiv.parentElement && !descDiv.parentElement.classList.contains('card-content')) {
                        descParent = descDiv.parentElement;
                    }
                    currentDescText = descDiv.textContent;
                }

                // card-desc ìš”ì†Œë¥¼ ì°¾ì§€ ëª»í–ˆë‹¤ë©´ (ì´ë¯¸ ìˆ˜ì • ëª¨ë“œì´ê±°ë‚˜ êµ¬ì¡° ë¬¸ì œ) ë¦¬í„´
                if (!descDiv && !descParent) {
                    console.error("ì„¤ëª… ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }

                const currentDesc = currentDescText || (descDiv ? descDiv.textContent : '');

                card.classList.add('editing');

                // ëª¨ë“  ì¹´í…Œê³ ë¦¬ì—ì„œ ì œëª©ì„ textareaë¡œ í‘œì‹œ (ê¸´ ì œëª© ì§€ì› ë° ì „ì²´ í‘œì‹œ)
                // ëª¨ë“  ì¹´í…Œê³ ë¦¬ì—ì„œ ì œëª©ì„ textareaë¡œ í‘œì‹œ (ê¸´ ì œëª© ì§€ì› ë° ì „ì²´ í‘œì‹œ)
                // ì´ˆê¸°ì—ëŠ” rowsë¥¼ ì ë‹¹íˆ ì£¼ê³ , ë Œë”ë§ í›„ scrollHeightë¡œ ìë™ ì¡°ì ˆ
                // styleì— white-space: pre-wrap; word-break: break-word; ì¶”ê°€í•˜ì—¬ ì¤„ë°”ê¿ˆ ê°•ì œ
                termDiv.innerHTML = `<textarea class="inline-textarea" rows="1" style="overflow-y:hidden; resize:none; white-space: pre-wrap; word-break: break-word;">${currentTerm}</textarea>`;

                // ë‚´ìš© ìˆ˜ì • ì°½ë„ ë™ì¼í•˜ê²Œ ì²˜ë¦¬
                // descParentê°€ ìˆìœ¼ë©´ (ì ‘ê¸°/í¼ì¹˜ê¸° êµ¬ì¡°) ì „ì²´ë¥¼ textareaë¡œ êµì²´í•˜ë˜, ë‚˜ì¤‘ì— ë³µì›ì„ ìœ„í•´ ì‹ë³„ì ìœ ì§€
                if (descParent) {
                    descParent.innerHTML = `<textarea class="inline-textarea card-desc-edit" rows="1" style="overflow-y:hidden; resize:none; white-space: pre-wrap; word-break: break-word;">${currentDesc}</textarea>`;
                } else {
                    descDiv.innerHTML = `<textarea class="inline-textarea" rows="1" style="overflow-y:hidden; resize:none; white-space: pre-wrap; word-break: break-word;">${currentDesc}</textarea>`;
                }

                const actionsDiv = card.querySelector('.card-actions');
                actionsDiv.innerHTML = `
                    <button class="inline-cancel-btn" onclick="toggleInlineEdit('${id}')">ì·¨ì†Œ</button>
                    <button class="inline-save-btn" onclick="saveInlineEdit('${id}')">ì €ì¥</button>
                `;

                // ìë™ ë†’ì´ ì¡°ì ˆ í•¨ìˆ˜
                const autoResize = (el) => {
                    el.style.height = 'auto'; // ë†’ì´ ì´ˆê¸°í™” í›„ ì¬ê³„ì‚°
                    el.style.height = (el.scrollHeight + 2) + 'px'; // +2px ì—¬ìœ 
                };

                // ìƒì„±ëœ textareaë“¤ì— ëŒ€í•´ ë†’ì´ ìë™ ì¡°ì ˆ ì ìš©
                const editFields = card.querySelectorAll('.inline-textarea');

                // ë Œë”ë§ í›„ ë†’ì´ë¥¼ ê³„ì‚°í•˜ë„ë¡ ì¶©ë¶„í•œ ì§€ì—° ì‹œê°„ ë¶€ì—¬
                setTimeout(() => {
                    editFields.forEach(field => {
                        autoResize(field);
                    });
                }, 50); // ì§€ì—° ì‹œê°„ì„ 50msë¡œ ì¦ê°€

                editFields.forEach(field => {
                    // ì…ë ¥ ì‹œ ìë™ ì¡°ì ˆ
                    field.addEventListener('input', function () {
                        autoResize(this);
                    });

                    // í¬ì»¤ìŠ¤ ì‹œ ìë™ ìŠ¤í¬ë¡¤ ë°©ì§€
                    field.addEventListener('focus', function (e) {
                        const scrollY = window.scrollY;
                        setTimeout(() => {
                            window.scrollTo(0, scrollY);
                        }, 0);
                    }, { once: true });
                });
            }
        }

        // ì¸ë¼ì¸ ìˆ˜ì • ì €ì¥ (ì•ˆì „í•œ ë™ê¸°í™” ë°©ì‹)
        function saveInlineEdit(id) {
            const card = document.querySelector(`.card[data-id="${id}"]`);

            // ì œëª©ì€ textarea (ì¸ë¼ì¸ ìˆ˜ì • ëª¨ë“œ)
            const termTextarea = card.querySelector('.card-term .inline-textarea');
            const term = termTextarea ? termTextarea.value.trim() : '';

            // ë‚´ìš©ì€ ë‘ ë²ˆì§¸ textarea ì°¾ê¸° (card-desc í´ë˜ìŠ¤ê°€ ìˆ˜ì • ëª¨ë“œì—ì„œ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ)
            const allTextareas = card.querySelectorAll('.inline-textarea');
            let description = '';
            if (allTextareas.length >= 2 && allTextareas[1]) {
                description = allTextareas[1].value.trim();
            } else {
                const descInput = card.querySelector('.inline-textarea.card-desc-edit') || card.querySelector('.card-desc .inline-textarea');
                description = descInput ? descInput.value.trim() : '';
            }

            if (!term || !description) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading(); // ì €ì¥ ì¤‘... (ì‚¬ìš©ì ì¡°ì‘ ì°¨ë‹¨)

            // ì„œë²„ ì €ì¥ ìš”ì²­ (ë¹„ë°€ë²ˆí˜¸ í¬í•¨)
            fetch(`${API_URL}?action=edit&id=${id}&term=${encodeURIComponent(term)}&description=${encodeURIComponent(description)}&sheetName=${currentSheet}&password=${encodeURIComponent(userPassword)}`)
                .then(res => res.json())
                .then(data => {
                    if (data.status === 'success') {
                        // ì„œë²„ ì €ì¥ ì„±ê³µ ì‹œì—ë§Œ ë¡œì»¬ ë°ì´í„° ì—…ë°ì´íŠ¸
                        if (cachedData && cachedData[currentSheet]) {
                            const itemIndex = cachedData[currentSheet].findIndex(item => String(item.id) === String(id));
                            if (itemIndex !== -1) {
                                cachedData[currentSheet][itemIndex].term = term;
                                cachedData[currentSheet][itemIndex].description = description;
                            }
                        }

                        // í™”ë©´ ê°±ì‹  (ë¦¬ë Œë”ë§ìœ¼ë¡œ ê¹”ë”í•˜ê²Œ ë³µêµ¬)
                        renderCurrentSheet();
                        // card.classList.remove('editing'); // ë Œë”ë§í•˜ë©´ ìë™ í•´ì œë¨
                    } else {
                        alert('ì €ì¥ ì‹¤íŒ¨: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                        // ì‹¤íŒ¨ ì‹œì—ëŠ” í™”ë©´ì„ ê·¸ëŒ€ë¡œ ë‘  (ë‹¤ì‹œ ì‹œë„í•  ìˆ˜ ìˆê²Œ)
                    }
                    hideLoading();
                })
                .catch(err => {
                    console.error('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜:', err);
                    alert('ì„œë²„ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    hideLoading();
                });
        }

        function enterEditMode(id, term, description) {
            toggleInlineEdit(id);
        }

        function cancelEdit() {
            // ìƒë‹¨ ì…ë ¥ì°½ ì´ˆê¸°í™” ìš©ë„ë¡œë§Œ ì‚¬ìš©
            document.getElementById('term').value = '';
            document.getElementById('description').value = '';
        }

        // ë°ì´í„° ë“±ë¡ (ì•ˆì „í•œ ë™ê¸°í™” ë°©ì‹)
        function saveData() {
            console.log('saveData í˜¸ì¶œë¨, í˜„ì¬ ì‹œíŠ¸:', currentSheet);
            const term = document.getElementById('term').value.trim();
            const description = document.getElementById('description').value.trim();

            if (!term || !description) {
                let typeName = 'ë°ì´í„°';
                if (currentSheet === 'Coding') typeName = 'ìš©ì–´';
                else if (currentSheet === 'Prompt') typeName = 'í”„ë¡¬í”„íŠ¸';
                else if (currentSheet === 'URL') typeName = 'ì°¸ê³  ì œëª©';
                else if (currentSheet === 'Ideas') typeName = 'ì•„ì´ë””ì–´ ì œëª©';
                else if (currentSheet === 'WorkProcess') typeName = 'ì‹¤ì „ ì œëª©';
                else if (currentSheet === 'Jungri') typeName = 'ê°•ì˜ ì œëª©';
                else if (currentSheet === 'Customer') typeName = 'ì†ë‹˜ ì œëª©';
                else if (currentSheet === 'Visit') typeName = 'ë°©ë¬¸ ì¼ì •';
                else if (currentSheet === 'ItemDetail') typeName = 'ë¬¼ê±´ ì´ë¦„';
                else if (currentSheet === 'Private') typeName = 'ìë£Œ ì œëª©';

                alert(`${typeName}ì™€ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
                return;
            }

            showLoading(); // ì €ì¥ ì¤‘... (ì‚¬ìš©ì ì¡°ì‘ ì°¨ë‹¨)

            // ì„œë²„ ì €ì¥ ìš”ì²­ (GET ë°©ì‹ ì‚¬ìš© - GAS ì½”ë“œ í˜¸í™˜ì„±)
            // ì£¼ì˜: ê¸°ì¡´ ì½”ë“œëŠ” POST(no-cors)ë¥¼ ì¼ìœ¼ë‚˜, no-corsëŠ” ì‘ë‹µì„ ëª» ë°›ìŒ (opaque response)
            // ë”°ë¼ì„œ ì„±ê³µ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ë ¤ë©´ GET ë°©ì‹(JSONP ëŠë‚Œ)ì´ë‚˜ ì¼ë°˜ fetchë¥¼ ì¨ì•¼ í•¨.
            // ì—¬ê¸°ì„œëŠ” GET ë°©ì‹ì´ ê°€ì¥ í™•ì‹¤í•˜ê²Œ JSON ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆìŒ. (ê¸¸ì´ ì œí•œì´ ìˆì§€ë§Œ í…ìŠ¤íŠ¸ ìœ„ì£¼ë¼ ê´œì°®ì„ ë“¯)
            // ë§Œì•½ POSTë¥¼ ì¨ì•¼ í•œë‹¤ë©´ GAS ì„¤ì •ì„ ì˜ ë§ì¶°ì•¼ í•¨.
            // ì•ˆì „í•˜ê²Œ ê¸°ì¡´ GET ë°©ì‹(`action=add`)ì„ ì‚¬ìš©í•˜ë˜, ë°ì´í„°ëŠ” ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë³´ëƒ„.

            fetch(`${API_URL}?action=add&term=${encodeURIComponent(term)}&description=${encodeURIComponent(description)}&sheetName=${currentSheet}&password=${encodeURIComponent(userPassword)}`)
                .then(res => res.json())
                .then(data => {
                    if (data.status === 'success') {
                        // ì„œë²„ ì €ì¥ ì„±ê³µ! -> ë¡œì»¬ ë°ì´í„°ì— ì¶”ê°€
                        const newItem = {
                            id: data.id, // ì„œë²„ì—ì„œ ë°œê¸‰ëœ ì§„ì§œ ID ì‚¬ìš©
                            term: term,
                            description: description,
                            timestamp: new Date().toISOString()
                        };

                        if (!cachedData[currentSheet]) cachedData[currentSheet] = [];
                        cachedData[currentSheet].unshift(newItem); // ìµœì‹  í•­ëª©ì´ ë§¨ ìœ„ë¡œ

                        // ì…ë ¥ í¼ ì´ˆê¸°í™”
                        document.getElementById('term').value = '';
                        document.getElementById('description').value = '';

                        // í™”ë©´ ê°±ì‹ 
                        renderCurrentSheet();
                    } else {
                        alert('ë“±ë¡ ì‹¤íŒ¨: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                    }
                    hideLoading();
                })
                .catch(err => {
                    console.error('ë“±ë¡ ì˜¤ë¥˜:', err);
                    alert('ì„œë²„ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ë°ì´í„°ê°€ ì €ì¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤)');
                    hideLoading();
                });
        }

        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€ ë° ë Œë”ë§ í˜¸ì¶œ)
        function loadData(sortType) {
            currentSort = sortType;
            if (cachedData) {
                renderCurrentSheet();
            } else {
                fetchAllData();
            }
        }

        // UIì— ì¹´ë“œ ì¦‰ì‹œ ì¶”ê°€í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function addCardToUI(item) {
            const container = document.getElementById('list-container');

            // ì•ˆì „ì¥ì¹˜: containerê°€ ì—†ìœ¼ë©´ ì˜¤ë¥˜ ë°©ì§€
            if (!container) {
                console.error('list-container ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }

            const card = document.createElement('div');
            card.className = 'card';
            card.setAttribute('data-id', item.id);

            const isLecture = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);
            const description = linkify(item.description);
            const descriptionText = String(item.description || '');
            const lines = descriptionText.split('\n');
            const isLongContent = lines.length > 1;

            let descHtml = '';
            if (isLecture && isLongContent) {
                descHtml = `
                    <div>
                        <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                        <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                    </div>
                `;
            } else {
                descHtml = `<div class="card-desc">${description}</div>`;
            }

            card.innerHTML = `
                <input type="checkbox" class="chk-box" data-id="${item.id}">
                <div class="card-content">
                    <div class="card-term">${item.term}</div>
                    ${descHtml}
                </div>
                <div class="card-actions">
                    <button class="edit-btn" onclick="toggleInlineEdit('${item.id}')">ìˆ˜ì •</button>
                </div>`;

            // ìµœì‹  í•­ëª©ì´ ë§¨ ìœ„ì— ì˜¤ë„ë¡ prepend
            container.prepend(card);
        }

        // í˜„ì¬ ì‹œíŠ¸ ë°ì´í„° ë Œë”ë§ (ì‹¤ì œ í™”ë©´ ì¶œë ¥ ë¡œì§)
        function renderCurrentSheet() {
            const container = document.getElementById('list-container');
            if (!cachedData) return;

            const data = [...(cachedData[currentSheet] || [])];

            // ì •ë ¬ ë²„íŠ¼ í™œì„±í™” í‘œì‹œ (ìœ„, ì•„ë˜ ë²„íŠ¼ ëª¨ë‘ ë™ê¸°í™”)
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll(`[data-sort="${currentSort}"]`).forEach(btn => btn.classList.add('active'));

            container.innerHTML = ''; // ì´ˆê¸°í™”

            if (data.length === 0) {
                let typeName = 'ë°ì´í„°';
                if (currentSheet === 'Coding') typeName = 'ìš©ì–´';
                else if (currentSheet === 'Prompt') typeName = 'í”„ë¡¬í”„íŠ¸';
                else if (currentSheet === 'URL') typeName = 'ì°¸ê³  ë‚´ìš©';
                else if (currentSheet === 'Ideas') typeName = 'ì•„ì´ë””ì–´';
                else if (currentSheet === 'WorkProcess') typeName = 'ì‹¤ì „ ê³¼ì •';
                else if (currentSheet === 'Jungri') typeName = 'ê°•ì˜ ì •ë¦¬';
                else if (currentSheet === 'Customer') typeName = 'ì†ë‹˜ ë‚´ìš©';
                else if (currentSheet === 'Visit') typeName = 'ë°©ë¬¸ ë°ì´í„°';
                else if (currentSheet === 'ItemDetail') typeName = 'ë¬¼ê±´ ë°ì´í„°';
                else if (currentSheet === 'Private') typeName = 'ê°œì¸ ìë£Œ';

                container.innerHTML = `<p style="text-align:center; color:#999; padding:40px;">ë“±ë¡ëœ ${typeName}ê°€ ì—†ìŠµë‹ˆë‹¤. ì²« ë°ì´í„°ë¥¼ ë“±ë¡í•´ë³´ì„¸ìš”!</p>`;
                return;
            }

            // ì •ë ¬ ì ìš©
            if (currentSort === 'newest') {
                data.reverse();
            } else if (currentSort === 'alphabet') {
                data.sort((a, b) => String(a.term).localeCompare(String(b.term), 'ko'));
            }

            data.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.setAttribute('data-id', item.id);

                // ëª¨ë“  ì‹œíŠ¸ì—ì„œ ë‚´ìš©ì´ 10ì¤„ì„ ë„˜ì–´ê°€ë©´ ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼ ì¶”ê°€
                const useCollapse = true;
                const description = linkify(item.description);
                // descriptionì„ ë¬¸ìì—´ë¡œ ë³€í™˜ í›„ split ì‚¬ìš© (ì•ˆì „ì„± í™•ë³´)
                const descriptionText = String(item.description || '');
                const lines = descriptionText.split('\n');
                const isLongContent = lines.length > 10; // 10ì¤„ ì´ˆê³¼ ì‹œ ë²„íŠ¼ ìƒì„±

                let descHtml = '';
                if (useCollapse && isLongContent) {
                    descHtml = `
                        <div>
                            <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                            <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                        </div>
                    `;
                } else {
                    descHtml = `<div class="card-desc">${description}</div>`;
                }

                card.innerHTML = `
                    <input type="checkbox" class="chk-box" data-id="${item.id}">
                    <div class="card-content">
                        <div class="card-term">${item.term}</div>
                        ${descHtml}
                    </div>
                    <div class="card-actions">
                        <button class="edit-btn" onclick="toggleInlineEdit('${item.id}')">ìˆ˜ì •</button>
                    </div>`;
                container.appendChild(card);
            });
        }

        // ê°•ì˜ ë‚´ìš© ì ‘ê¸°/í¼ì¹˜ê¸° í† ê¸€
        function toggleContent(id) {
            const descElement = document.getElementById(`desc-${id}`);
            const button = event.target;

            if (descElement.classList.contains('collapsed')) {
                descElement.classList.remove('collapsed');
                button.textContent = 'ì ‘ê¸° â–²';
            } else {
                descElement.classList.add('collapsed');
                button.textContent = 'ë”ë³´ê¸° â–¼';
            }
        }

        // ì •ë ¬ ë³€ê²½ (ì„œë²„ í˜¸ì¶œ ì—†ì´ ì¦‰ì‹œ ë°˜ì˜)
        function changeSort(sortType) {
            currentSort = sortType;
            renderCurrentSheet();
        }

        // ë°ì´í„° ìˆœì„œ ë³€ê²½ (í–‰ ì´ë™) - DOM ì§ì ‘ ì¡°ì‘ìœ¼ë¡œ ì†ë„ ê°œì„  & Down ë²„ê·¸ ìˆ˜ì •
        function reorderItem(direction) {
            const checkboxes = document.querySelectorAll('.chk-box:checked');
            if (checkboxes.length !== 1) {
                alert('ìˆœì„œë¥¼ ë³€ê²½í•  í•­ëª©ì„ 1ê°œë§Œ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê°€ë‚˜ë‹¤ìˆœì—ì„œëŠ” ìˆœì„œ ë³€ê²½ ë¶ˆê°€
            if (currentSort === 'alphabet') {
                alert('ê°€ë‚˜ë‹¤ìˆœì—ì„œëŠ” ìˆœì„œë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const id = checkboxes[0].dataset.id;
            const card = document.querySelector(`.card[data-id="${id}"]`);
            const container = document.getElementById('list-container');
            const data = cachedData[currentSheet]; // ì—‘ì…€ ìˆœì„œ(ì…ë ¥ìˆœ) ë°ì´í„°
            const index = data.findIndex(item => String(item.id) === String(id));

            if (index === -1 || !card) return;

            // 1. í™”ë©´ ê¸°ì¤€ ì´ë™ ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬
            const allCards = Array.from(container.children);
            const viewIndex = allCards.indexOf(card);

            // directionì€ í™”ë©´ ê¸°ì¤€
            if (direction === 'top' && viewIndex === 0) return alert('ì´ë¯¸ ë§¨ ìœ„ì…ë‹ˆë‹¤.');
            if (direction === 'bottom' && viewIndex === allCards.length - 1) return alert('ì´ë¯¸ ë§¨ ì•„ë˜ì…ë‹ˆë‹¤.');
            if (direction === 'up' && viewIndex === 0) return alert('ë” ì´ìƒ ì˜¬ë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            if (direction === 'down' && viewIndex === allCards.length - 1) return alert('ë” ì´ìƒ ë‚´ë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

            // 2. DOM ì´ë™ (View) - í™”ë©´ ê¸°ì¤€ direction ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì—¬ UI ì¦‰ì‹œ ë°˜ì˜
            if (direction === 'top') {
                container.prepend(card);
            } else if (direction === 'bottom') {
                container.append(card);
            } else if (direction === 'up') {
                if (card.previousElementSibling) {
                    container.insertBefore(card, card.previousElementSibling);
                }
            } else if (direction === 'down') {
                if (card.nextElementSibling) {
                    container.insertBefore(card, card.nextElementSibling.nextElementSibling);
                }
            }

            // 3. ë¡œì»¬ ë°ì´í„° ì¡°ì‘ (ì•ˆì „í•œ ë°©ë²•: DOM ìˆœì„œëŒ€ë¡œ ì¬ì •ë ¬)
            // ì¸ë±ìŠ¤ ê³„ì‚° ì˜¤ë¥˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´, í™”ë©´ì— ë³´ì´ëŠ” ìˆœì„œëŒ€ë¡œ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë§ì¶¤ (ì¤‘ìš”!)
            const newOrderIds = Array.from(container.children).map(c => c.dataset.id);
            const dataMap = new Map(data.map(item => [String(item.id), item]));

            // ë°ì´í„° ê°œìˆ˜ ë¬´ê²°ì„± ì²´í¬ (ì¤‘ìš”!)
            if (newOrderIds.length !== data.length) {
                console.error('ë°ì´í„° ë¶ˆì¼ì¹˜ ê°ì§€! ì €ì¥ ì¤‘ë‹¨');
                alert('í™”ë©´ê³¼ ë°ì´í„°ì˜ ê°œìˆ˜ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                return;
            }

            const newData = [];
            // í™”ë©´ ìˆœì„œëŒ€ë¡œ ë°ì´í„° ì¬êµ¬ì„±
            newOrderIds.forEach(id => {
                if (dataMap.has(String(id))) {
                    newData.push(dataMap.get(String(id)));
                }
            });

            // ì›ë³¸ ë°ì´í„°ê°€ 'ì…ë ¥ìˆœ'ìœ¼ë¡œ ì €ì¥ë˜ì–´ì•¼ í•˜ëŠ”ë°, í™”ë©´ì´ 'ìµœì‹ ìˆœ'ì´ë¼ë©´
            // newDataëŠ” ìµœì‹ ìˆœ(ì—­ìˆœ)ìœ¼ë¡œ ì •ë ¬ë˜ì–´ ìˆì„ ê²ƒì„.
            // ë”°ë¼ì„œ ì„œë²„ ì €ì¥ìš©(ì…ë ¥ìˆœ)ìœ¼ë¡œ ë˜ëŒë¦¬ë ¤ë©´ ë‹¤ì‹œ reverse() í•´ì¤˜ì•¼ í•¨.
            if (currentSort === 'newest') {
                newData.reverse();
            }

            // ìµœì¢… ë°ì´í„° êµì²´
            cachedData[currentSheet] = newData;

            // 4. ì„œë²„ ë™ê¸°í™” (ê¸°ì¡´ ë¡œì§ í™œìš©)
            // ì„œë²„/ë°ì´í„°(ì—‘ì…€) ê¸°ì¤€ ì´ë™ ë°©í–¥ ê²°ì •
            let serverDirection = direction;
            if (currentSort === 'newest') {
                // í™”ë©´ì´ ì—­ìˆœì´ë¯€ë¡œ, ë°©í–¥ì„ ë°˜ëŒ€ë¡œ í•´ì„
                if (direction === 'top') serverDirection = 'bottom';
                else if (direction === 'bottom') serverDirection = 'top';
                else if (direction === 'up') serverDirection = 'down';
                else if (direction === 'down') serverDirection = 'up';
            }

            // ë¹„ë°€ë²ˆí˜¸ í¬í•¨í•˜ì—¬ ì „ì†¡
            fetch(`${API_URL}?action=reorder&id=${id}&direction=${serverDirection}&sheetName=${currentSheet}&password=${encodeURIComponent(userPassword)}`)
                .then(res => res.json())
                .then(result => {
                    if (result.status !== 'success') {
                        console.error(result.message);
                        alert('ì„œë²„ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + result.message);
                    }
                })
                .catch(err => {
                    console.error('ìˆœì„œ ë³€ê²½ ì„œë²„ ìš”ì²­ ì‹¤íŒ¨:', err);
                    alert('ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });
        }

        // ì „ì²´ ì„ íƒ / í•´ì œ
        function toggleSelectAll() {
            const checkboxes = document.querySelectorAll('.chk-box');
            if (checkboxes.length === 0) return;

            // í•˜ë‚˜ë¼ë„ ì²´í¬ê°€ ì•ˆ ëœ ê²ƒì´ ìˆìœ¼ë©´ ì „ì²´ ì„ íƒ, ëª¨ë‘ ì²´í¬ë˜ì–´ ìˆìœ¼ë©´ ì „ì²´ í•´ì œ
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);

            checkboxes.forEach(cb => {
                cb.checked = !allChecked;
            });
        }

        // ì„ íƒ ì‚­ì œ
        function deleteSelected() {
            const checkboxes = document.querySelectorAll('.chk-box:checked');
            if (checkboxes.length === 0) {
                alert('ì‚­ì œí•  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!confirm(`ì„ íƒí•œ ${checkboxes.length}ê°œ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }

            const ids = Array.from(checkboxes).map(cb => cb.dataset.id);

            // ì¦‰ì‹œ UIì—ì„œ ì œê±° (ì†ë„ ê°œì„ )
            ids.forEach(id => {
                const card = document.querySelector(`.card[data-id="${id}"]`);
                if (card) card.remove();
            });

            // ìºì‹œëœ ë°ì´í„°ì—ì„œë„ ì œê±°
            if (cachedData && cachedData[currentSheet]) {
                cachedData[currentSheet] = cachedData[currentSheet].filter(item => !ids.includes(String(item.id)));
            }

            // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì„œë²„ ë™ê¸°í™” -> ì•ˆì „í•œ ë™ê¸°í™” ë°©ì‹(Blocking UI)ìœ¼ë¡œ ë³€ê²½
            // showLoading()ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì…ë ¥ì„ ë§‰ìŒ
            showLoading();

            // APIê°€ ë‹¤ì¤‘ ì‚­ì œë¥¼ ì§€ì›í•˜ë¯€ë¡œ(ids íŒŒë¼ë¯¸í„°), í•œ ë²ˆì— ìš”ì²­
            const url = `${API_URL}?action=delete&ids=${ids.join(',')}&sheetName=${currentSheet}&password=${encodeURIComponent(userPassword)}`;

            fetch(url)
                .then(res => res.json())
                .then(result => {
                    if (result.status === 'success') {
                        // ì„±ê³µ ì‹œì—ë§Œ UI ë° ë¡œì»¬ ë°ì´í„° ì‚­ì œ
                        ids.forEach(id => {
                            const card = document.querySelector(`.card[data-id="${id}"]`);
                            if (card) card.remove();
                        });

                        if (cachedData && cachedData[currentSheet]) {
                            cachedData[currentSheet] = cachedData[currentSheet].filter(item => !ids.includes(String(item.id)));
                        }
                    } else {
                        alert('ì‚­ì œ ì‹¤íŒ¨: ' + (result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                        // ì‹¤íŒ¨ ì‹œ UIëŠ” ê·¸ëŒ€ë¡œ ë‘  (ì‚­ì œë˜ì§€ ì•ŠìŒ)
                    }
                    hideLoading();
                })
                .catch(err => {
                    console.error('ì‚­ì œ ì˜¤ë¥˜:', err);
                    alert('ì„œë²„ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    hideLoading();
                });   // ì„ íƒ ì´ë™
        }
        function moveSelected() {
            const checkboxes = document.querySelectorAll('.chk-box:checked');
            if (checkboxes.length === 0) {
                alert('ì´ë™í•  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // í™•ì¥í˜•(ê°•ì˜ì •ë¦¬ ë“±)ì€ ê¸°ë³¸í˜•ê³¼ í¼ êµ¬ì¡°ê°€ ë‹¬ë¼ ì´ë™ ë¶ˆê°€ (ì„œë¡œ í˜¸í™˜ë˜ëŠ” ê²ƒë¼ë¦¬ëŠ” ê°€ëŠ¥í•˜ì§€ë§Œ ë³µì¡ë„ ì¤„ì´ê¸° ìœ„í•´ ì œí•œ)
            const isExtendedForm = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);

            if (isExtendedForm) {
                alert('ì´ ì¹´í…Œê³ ë¦¬(í™•ì¥í˜•)ì˜ í•­ëª©ì€ ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ëª¨ë‹¬ ì—´ê¸°
            window.selectedCheckboxes = checkboxes;
            showMoveModal();

        }

        // ëª¨ë‹¬ ì—´ê¸°
        function showMoveModal() {
            const modal = document.getElementById('moveModal');
            const buttonsContainer = document.getElementById('categoryButtons');

            // ë²„íŠ¼ ìƒì„± (ê°•ì˜ì •ë¦¬ ì œì™¸)
            const categories = [
                { name: 'Coding', label: 'Codingìš©ì–´' },
                { name: 'Prompt', label: 'í”„ë¡¬í”„íŠ¸' },
                { name: 'URL', label: 'ì°¸ê³ URL' },
                { name: 'Ideas', label: 'ì•„ì´ë””ì–´' },
                { name: 'WorkProcess', label: 'ì‹¤ì „ê³¼ì •' },
                { name: 'Jungri', label: 'ê°•ì˜ì •ë¦¬' },
                { name: 'Customer', label: 'ì†ë‹˜ë‚´ìš©' },
                { name: 'Visit', label: 'ë°©ë¬¸ì˜ˆì •' },
                { name: 'ItemDetail', label: 'ë¬¼ê±´ì„¸ë¶€' },
                { name: 'Private', label: 'ê°œì¸ìë£Œ' }
            ];

            buttonsContainer.innerHTML = '';
            categories.forEach(cat => {
                if (cat.name !== currentSheet) {
                    const btn = document.createElement('button');
                    btn.className = 'category-btn';
                    btn.textContent = cat.label;
                    btn.onclick = () => executeMoveToCategory(cat.name);
                    buttonsContainer.appendChild(btn);
                }
            });

            modal.classList.add('active');
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeMoveModal() {
            const modal = document.getElementById('moveModal');
            modal.classList.remove('active');
        }

        // ì‹¤ì œ ì´ë™ ì‹¤í–‰ (ì•ˆì „í•œ ë™ê¸°í™” ë°©ì‹)
        function executeMoveToCategory(targetSheet) {
            closeMoveModal();

            const checkboxes = window.selectedCheckboxes;
            const ids = Array.from(checkboxes).map(cb => cb.dataset.id);

            // ì´ë™í•  ëŒ€ìƒ ìºì‹œ ë°ì´í„° ë¯¸ë¦¬ í™•ë³´ (ì„±ê³µ ì‹œ ì‚¬ìš©)
            let movedItems = [];
            if (cachedData && cachedData[currentSheet]) {
                movedItems = cachedData[currentSheet].filter(item => ids.includes(String(item.id)));
            }

            showLoading(); // ì´ë™ ì¤‘...

            const url = `${API_URL}?action=move&ids=${ids.join(',')}&sheetName=${currentSheet}&targetSheet=${targetSheet}&password=${encodeURIComponent(userPassword)}`;

            fetch(url)
                .then(res => res.json())
                .then(result => {
                    if (result.status === 'success') {
                        // ì„±ê³µ ì‹œ UI ì œê±° ë° ìºì‹œ ì´ë™
                        ids.forEach(id => {
                            const card = document.querySelector(`.card[data-id="${id}"]`);
                            if (card) card.remove();
                        });

                        // í˜„ì¬ ì‹œíŠ¸ì—ì„œ ë°ì´í„° ì œê±°
                        if (cachedData && cachedData[currentSheet]) {
                            cachedData[currentSheet] = cachedData[currentSheet].filter(item => !ids.includes(String(item.id)));
                        }

                        // íƒ€ê²Ÿ ì‹œíŠ¸ ìºì‹œê°€ ìˆë‹¤ë©´ ì¶”ê°€ (ì—†ìœ¼ë©´ ë‚˜ì¤‘ì— ë¡œë“œí•  ë•Œ ë°›ì•„ì˜´)
                        if (cachedData[targetSheet]) {
                            cachedData[targetSheet] = [...movedItems, ...cachedData[targetSheet]];
                        } else {
                            // íƒ€ê²Ÿ ì‹œíŠ¸ ë°ì´í„°ê°€ ì•„ì§ ë¡œë“œ ì•ˆ ëë‹¤ë©´ êµ³ì´ ì¶”ê°€í•  í•„ìš” ì—†ìŒ (ì´ˆê¸°í™” ìƒíƒœ)
                        }

                        // alert('ì´ë™ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    } else {
                        alert('ì´ë™ ì‹¤íŒ¨: ' + (result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                        // ì‹¤íŒ¨ ì‹œ UI ê·¸ëŒ€ë¡œ ìœ ì§€ (ì´ë™ ì•ˆ ë¨)
                    }
                    hideLoading();
                })
                .catch(err => {
                    console.error('ì´ë™ ì˜¤ë¥˜:', err);
                    alert('ì„œë²„ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    hideLoading();
                });
        }
    </script>
</body>

</html>