<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ì½”ë”© ìš©ì–´ ì •ë¦¬</title>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ê´€ê³µì„œ ìŠ¤íƒ€ì¼: ê¹¨ë—í•œ í°ìƒ‰ ë°°ê²½ê³¼ ì‹ ë¢°ê° ìˆëŠ” ë‚¨ìƒ‰ í¬ì¸íŠ¸ */
        body {
            background: #f4f7f9;
            color: #333;
            font-family: 'Nanum Gothic', 'Malgun Gothic', sans-serif;
            padding: 40px 20px;
            margin: 0;
            line-height: 1.6;
            font-size: 16px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #ffffff;
            padding: 30px;
            border-top: 6px solid #003366;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        h2 {
            text-align: center;
            color: #003366;
            margin-bottom: 20px;
            font-size: 32px;
            font-weight: bold;
        }

        /* ì…ë ¥ ì˜ì—­ */
        .input-box {
            border: 1px solid #d1d1d1;
            padding: 20px;
            margin-bottom: 30px;
            background: #fff;
        }

        .input-row {
            display: flex;
            align-items: flex-start;
            /* ìƒë‹¨ ì •ë ¬ë¡œ ë³€ê²½ (textarea í™•ì¥ ëŒ€ì‘) */
            margin-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 15px;
        }

        .label {
            width: 120px;
            font-weight: bold;
            color: #555;
            font-size: 15px;
            padding-top: 10px;
            /* input/textareaì™€ ë†’ì´ ë§ì¶¤ */
            flex-shrink: 0;
            /* ë¼ë²¨ ë„ˆë¹„ ê³ ì • */
        }

        input,
        textarea {
            flex: 1;
            width: 100%;
            /* ë„ˆë¹„ ê½‰ ì±„ìš°ê¸° */
            box-sizing: border-box;
            /* íŒ¨ë”© í¬í•¨ ë„ˆë¹„ ê³„ì‚° */
            padding: 10px;
            border: 1px solid #ccc;
            background: #fafafa;
            font-size: 14px;
        }

        .save-btn {
            background: #003366;
            color: white;
            padding: 12px 0;
            border: none;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            transition: background 0.2s;
        }

        .save-btn.edit-mode {
            background: #f0ad4e;
            /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì˜¤ë Œì§€ìƒ‰ ê³„ì—´ë¡œ ë³€ê²½ */
        }

        .edit-btn {
            background: #5bc0de;
            color: white;
            border: none;
            padding: 4px 10px;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            border-radius: 3px;
        }

        .inline-save-btn,
        .inline-cancel-btn {
            display: block;
            width: 100%;
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            border-radius: 3px;
            margin-bottom: 5px;
        }

        .inline-save-btn {
            background: #5cb85c;
            color: white;
        }

        .inline-cancel-btn {
            background: #999;
            color: white;
        }

        .inline-input,
        .inline-textarea {
            width: 100%;
            padding: 8px;
            font-size: 10pt;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            font-family: inherit;
            scroll-margin-top: 100px;
            /* í¬ì»¤ìŠ¤ ì‹œ ìë™ ìŠ¤í¬ë¡¤ ë°©ì§€ */
            overflow: hidden;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ (ë†’ì´ ìë™ ì¡°ì ˆ ì‚¬ìš©) */
            min-height: 40px;
            white-space: pre-wrap;
            /* ì¤„ë°”ê¿ˆ í—ˆìš© */
            word-break: break-word;
            /* ê¸´ ë‹¨ì–´ ì¤„ë°”ê¿ˆ */
        }

        .inline-input {
            height: auto;
            min-height: 40px;
            line-height: 1.5;
        }

        .edit-cancel-btn {
            background: #666;
            color: white;
            padding: 12px 0;
            border: none;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 5px;
            display: none;
            /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        }

        /* ì»¨íŠ¸ë¡¤ ë° ì •ë ¬ */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            border-bottom: 2px solid #003366;
            padding-bottom: 8px;
        }

        .delete-btn {
            background: #d9534f;
            color: white;
            border: none;
            padding: 6px 15px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
        }

        .move-btn {
            background: #5cb85c;
            color: white;
            border: none;
            padding: 6px 15px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            margin-left: 5px;
        }

        .sort-btn {
            padding: 6px 12px;
            font-size: 13px;
            background: #f8f8f8;
            border: 1px solid #ddd;
            cursor: pointer;
            margin-left: 4px;
        }

        .sort-btn.active {
            background: #003366;
            color: #fff;
            font-weight: bold;
        }

        .select-btn {
            background: #666;
            color: white;
            border: none;
            padding: 6px 15px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            margin-right: 5px;
        }

        /* ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ */
        .card {
            display: flex;
            align-items: flex-start;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            background: #fff;
            text-align: left;
        }

        .chk-box {
            margin-right: 12px;
            margin-top: 5px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            flex: none;
        }

        .card-term {
            width: 200px;
            font-weight: bold;
            color: #003366;
            font-size: 10pt;
            margin-right: 20px;
            flex-shrink: 0;
            word-break: keep-all;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì œëª© ì˜ì—­ì´ í™•ì¥ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì • */
        .card.editing .card-term {
            width: auto;
            min-width: 200px;
            max-width: 100%;
            flex-shrink: 1;
        }

        /* ì œëª© textareaê°€ ë¶€ëª¨ ë„ˆë¹„ë¥¼ ë”°ë¥´ë„ë¡ ì„¤ì • */
        .card-term .inline-textarea {
            width: 100% !important;
            box-sizing: border-box;
            min-width: 200px;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì¹´ë“œ ì»¨í…íŠ¸ë¥¼ ì„¸ë¡œ ë°°ì¹˜ë¡œ ë³€ê²½ */
        .card.editing .card-content {
            display: flex;
            flex-direction: column;
            /* ì œëª©ê³¼ ë‚´ìš©ì„ ì„¸ë¡œë¡œ ë°°ì¹˜ */
            align-items: stretch;
            /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
            width: 100%;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ë‚´ìš© textareaê°€ ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
        .card.editing .card-desc,
        .card.editing .card-desc .inline-textarea {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ê°•ì˜ì •ë¦¬/ì‹¤ì „ê³¼ì •ì˜ wrapper divë„ ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
        .card.editing .card-content>div {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box;
            flex: 1;
        }

        /* ëª¨ë“  inline-textareaê°€ ë¶€ëª¨ ë„ˆë¹„ë¥¼ ì™„ì „íˆ ì±„ìš°ë„ë¡ ê°•ì œ */
        .card.editing .inline-textarea {
            width: 100% !important;
            max-width: 100% !important;
            min-width: 100% !important;
            box-sizing: border-box !important;
        }

        /* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ì œëª© ì˜ì—­ë„ ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
        .card.editing .card-term {
            width: 100% !important;
            max-width: 100% !important;
            margin-right: 0;
            margin-bottom: 10px;
            /* ì œëª©ê³¼ ë‚´ìš© ì‚¬ì´ ê°„ê²© */
        }

        .card-desc {
            flex: 1;
            color: #444;
            font-size: 10pt;
            white-space: pre-wrap;
            line-height: 1.5;
        }

        /* ì ‘ê¸°/í¼ì¹˜ê¸° ê¸°ëŠ¥ */
        .card-desc.collapsed {
            max-height: 1.5em;
            overflow: hidden;
            position: relative;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: #003366;
            cursor: pointer;
            font-size: 9pt;
            padding: 2px 5px;
            margin-left: 5px;
            text-decoration: underline;
            font-weight: bold;
        }

        .toggle-btn:hover {
            color: #0056b3;
        }

        /* ë¡œë”© ì¸ë””ì¼€ì´í„° */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #003366;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            margin-top: 20px;
            color: #003366;
            font-size: 16px;
            font-weight: bold;
        }

        /* ì¹´í…Œê³ ë¦¬ ì´ë™ ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 90%;
        }

        .modal-title {
            font-size: 18px;
            font-weight: bold;
            color: #003366;
            margin-bottom: 20px;
            text-align: center;
        }

        .category-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .category-btn {
            background: #f0f0f0;
            border: 2px solid #ddd;
            padding: 15px;
            font-size: 14px;
            font-weight: bold;
            color: #003366;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.2s;
        }

        .category-btn:hover {
            background: #003366;
            color: white;
            border-color: #003366;
        }

        .modal-close {
            margin-top: 15px;
            background: #999;
            color: white;
            border: none;
            padding: 10px;
            width: 100%;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
        }

        .modal-close:hover {
            background: #666;
        }

        /* í•˜ì´í¼ë§í¬ ìŠ¤íƒ€ì¼ */
        .card-desc a {
            color: #003366 !important;
            text-decoration: underline !important;
            font-weight: bold;
        }

        .card-desc a:hover {
            color: #0056b3 !important;
        }

        /* í…ìŠ¤íŠ¸ ë˜í¼ (PC ê¸°ë³¸) */
        .card-content {
            display: flex;
            flex: 1;
            align-items: flex-start;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            h2 {
                font-size: 24px;
                margin-bottom: 20px;
            }

            /* ì…ë ¥ í¼ ìˆ˜ì§ ë°°ì¹˜ */
            .input-row {
                flex-direction: column;
                align-items: stretch;
            }

            .label {
                width: 100%;
                margin-bottom: 8px;
            }

            /* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ ëª¨ë°”ì¼ ìµœì í™” */
            .controls {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .controls>div {
                display: flex;
                justify-content: space-between;
                width: 100%;
            }

            .select-btn,
            .delete-btn,
            .move-btn {
                flex: 1;
                margin: 0 2px;
                padding: 8px 0;
                /* ì¢Œìš° íŒ¨ë”© ì œê±° í›„ ì¤‘ì•™ ì •ë ¬ */
                text-align: center;
                font-size: 13px;
                white-space: nowrap;
            }

            .select-btn {
                margin-left: 0;
            }

            .move-btn {
                margin-right: 0;
            }

            .sort-btn {
                flex: 1;
                text-align: center;
                margin: 0 2px;
            }

            /* ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ ìˆ˜ì§ ë°°ì¹˜ */
            .card-content {
                display: block;
            }

            .card-term {
                width: 100%;
                margin-right: 0;
                margin-bottom: 6px;
                border-bottom: 1px dashed #eee;
                padding-bottom: 4px;
            }

            .card-desc {
                width: 100%;
            }
        }

        /* íƒ­ ìŠ¤íƒ€ì¼ - PCì—ì„œ í•œ ì¤„ ê½‰ ì°¨ê²Œ */
        .tabs {
            display: grid;
            grid-auto-flow: column;
            grid-auto-columns: minmax(0, 1fr);
            /* ì¤‘ìš”: ìµœì†Œ í¬ê¸° 0ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ë¬´ì¡°ê±´ ê· ë“± ë¶„í•  */
            gap: 2px;
            margin-bottom: 0;
            border-bottom: 2px solid #003366;
            padding-bottom: 0px;
        }



        .tab {
            width: 100%;
            /* ì…€ ê½‰ ì±„ìš°ê¸° */
            padding: 12px 2px;
            /* ì¢Œìš° ì—¬ë°± ìµœì†Œí™” */
            text-align: center;
            white-space: nowrap;
            cursor: pointer;
            background: #f1f3f5;
            border: 1px solid #ddd;
            border-bottom: none;
            font-weight: bold;
            color: #555;
            border-radius: 5px 5px 0 0;
            /* ìœ„ìª½ë§Œ ë‘¥ê¸€ê²Œ */
            transition: all 0.2s;
            font-size: 13.5px;
            overflow: hidden;
            text-overflow: ellipsis;
            /* ê¸€ì ë„˜ì¹˜ë©´ ë§ì¤„ì„ */
            -webkit-overflow-scrolling: touch;
            /* ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ ë¶€ë“œëŸ½ê²Œ */
        }

        .order-btn {
            background: #fff;
            border: 1px solid #ccc;
            padding: 6px 8px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            margin-right: 2px;
            transition: all 0.2s;
        }

        .order-btn:hover {
            background: #e9ecef;
        }

        .tabs::-webkit-scrollbar {
            display: none;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
        }

        .tab:hover {
            background: #e0e4e8;
            color: #003366;
        }

        .tab.active {
            background: #003366;
            color: white;
            border-color: #003366;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .tabs {
                display: flex;
                /* ëª¨ë°”ì¼ì€ Flexë¡œ ì „í™˜ */
                flex-wrap: wrap;
                /* ëª¨ë°”ì¼ì—ì„œëŠ” ì¤„ë°”ê¿ˆ í—ˆìš© */
                overflow-x: visible;
                gap: 4px;
                padding-bottom: 5px;
            }

            .tab {
                flex: 1 1 calc(33% - 4px);
                /* í•œ ì¤„ì— 3ê°œì”© */
                font-size: 12px;
                padding: 10px 5px;
                border-radius: 5px;
                border: 1px solid #ddd;
            }
        }

        .input-box {
            border-top: none;
            /* íƒ­ê³¼ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²° */
        }
    </style>
</head>

<body>
    <!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>

    <div class="container">
        <h2>ì½”ë”© ìš©ì–´ ì •ë¦¬</h2>

        <div class="tabs">
            <div class="tab Active" id="tab-coding" onclick="switchTab('Coding')">Codingìš©ì–´</div>
            <div class="tab" id="tab-prompt" onclick="switchTab('Prompt')">í”„ë¡¬í”„íŠ¸</div>
            <div class="tab" id="tab-url" onclick="switchTab('URL')">ì°¸ê³ URL</div>
            <div class="tab" id="tab-ideas" onclick="switchTab('Ideas')">ì•„ì´ë””ì–´</div>
            <div class="tab" id="tab-workprocess" onclick="switchTab('WorkProcess')">ì‹¤ì „ê³¼ì •</div>
            <div class="tab" id="tab-jungri" onclick="switchTab('Jungri')">ê°•ì˜ì •ë¦¬</div>
            <div class="tab" id="tab-customer" onclick="switchTab('Customer')">ì†ë‹˜ë‚´ìš©</div>
            <div class="tab" id="tab-visit" onclick="switchTab('Visit')">ë°©ë¬¸ì˜ˆì •</div>
            <div class="tab" id="tab-itemdetail" onclick="switchTab('ItemDetail')">ë¬¼ê±´ì„¸ë¶€</div>
            <div class="tab" id="tab-private" onclick="switchTab('Private')">ê°œì¸ìë£Œ</div>
        </div>

        <div class="input-box">
            <div class="input-row">
                <div class="label">ìš©ì–´</div>
                <input type="text" id="term" placeholder="ìš©ì–´">
            </div>

            <!-- ì¹´í…Œê³ ë¦¬ ì´ë™ ëª¨ë‹¬ -->
            <div id="moveModal" class="modal">
                <div class="modal-content">
                    <div class="modal-title">ì´ë™í•  ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
                    <div class="category-buttons" id="categoryButtons">
                        <!-- ë²„íŠ¼ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                    <button class="modal-close" onclick="closeMoveModal()">ì·¨ì†Œ</button>
                </div>
            </div>
            <div class="input-row" style="border:none;">
                <div class="label">ìš©ì–´ ì„¤ëª…</div>
                <textarea id="description" rows="3"></textarea>
            </div>
            <button id="btn-save" class="save-btn" onclick="saveData()">ë°ì´í„° ë“±ë¡</button>
            <button id="btn-cancel" class="edit-cancel-btn" onclick="cancelEdit()">ìˆ˜ì • ì·¨ì†Œ</button>
        </div>

        <div class="controls">
            <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 5px;">
                <button class="select-btn" onclick="toggleSelectAll()">ì „ì²´ ì„ íƒ</button>
                <div style="margin-left:auto; display:flex; gap:2px;">
                    <button class="order-btn" onclick="reorderItem('top')" title="ë§¨ ìœ„ë¡œ">â«</button>
                    <button class="order-btn" onclick="reorderItem('up')" title="ìœ„ë¡œ">ğŸ”¼</button>
                    <button class="order-btn" onclick="reorderItem('down')" title="ì•„ë˜ë¡œ">ğŸ”½</button>
                    <button class="order-btn" onclick="reorderItem('bottom')" title="ë§¨ ì•„ë˜ë¡œ">â¬</button>
                </div>
                <button class="delete-btn" onclick="deleteSelected()">ì„ íƒ ì‚­ì œ</button>
                <button class="move-btn" onclick="moveSelected()">ì„ íƒ ì´ë™</button>
            </div>
            <div style="margin-top: 5px;">
                <button class="sort-btn" id="btn-custom" onclick="changeSort('custom')">ì…ë ¥ìˆœ</button>
                <button class="sort-btn active" id="btn-newest" onclick="changeSort('newest')">ìµœì‹ ìˆœ</button>
                <button class="sort-btn" id="btn-alphabet" onclick="changeSort('alphabet')">ê°€ë‚˜ë‹¤ìˆœ</button>
            </div>
        </div>

        <div id="list-container">
        </div>
    </div>

    <script>
        // êµ¬ê¸€ ì›¹ ì•± URL (ìµœì¢… ë°°í¬ ë²„ì „)
        const API_URL = "https://script.google.com/macros/s/AKfycbyw-piHlXPykbEjMVzBE02VaoGpZ7x9X0AhSlyPaIKQHVGXIbF9IIffjXdvaYTXvAV1rQ/exec";

        let currentSort = 'newest';
        let currentSheet = 'Coding'; // í˜„ì¬ ì„ íƒëœ ì‹œíŠ¸ì´ë¦„ (íƒ­ ìƒíƒœ)
        let cachedData = null; // ëª¨ë“  ì‹œíŠ¸ ë°ì´í„°ë¥¼ ì €ì¥í•  ë³€ìˆ˜

        // URLê³¼ ì „í™”ë²ˆí˜¸ë¥¼ í•˜ì´í¼ë§í¬ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        function linkify(text) {
            if (!text) return "";
            let result = text.toString();

            // 1. URL ë³€í™˜ (ê¸°ì¡´ ë¡œì§)
            const urlPattern = /((?:https?|ftp):\/\/[^\s]+|\b[a-z0-9.-]+\.(?:com|net|org|kr|io|dev|pages\.dev|me|info)(?:\/[^\s]*)?\b)/gim;
            result = result.replace(urlPattern, function (url) {
                // ì´ë¯¸ ë§í¬ íƒœê·¸ì˜ ì¼ë¶€ì¸ ê²½ìš°(ì˜ˆ: href="...") ê±´ë„ˆë›°ê¸° (ê°„ë‹¨í•œ ì²´í¬)
                if (url.startsWith('href="')) return url;

                let href = url;
                if (!/^https?:\/\//i.test(url)) {
                    href = 'https://' + url;
                }
                return `<a href="${href}" target="_blank" rel="noopener noreferrer">${url}</a>`;
            });

            // 2. ì „í™”ë²ˆí˜¸ ë³€í™˜ (010, 02 ë“±ìœ¼ë¡œ ì‹œì‘í•˜ê³  í•˜ì´í”ˆ í¬í•¨)
            // ì˜ˆ: 010-1234-5678, 02-123-4567
            const phonePattern = /\b(0\d{1,2})-(\d{3,4})-(\d{4})\b/g;
            result = result.replace(phonePattern, function (match, p1, p2, p3) {
                // ì´ë¯¸ URL ë³€í™˜ ê³¼ì •ì—ì„œ ë§í¬ì˜ ì¼ë¶€ê°€ ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì€ ë§¤ìš° ë‚®ì§€ë§Œ(ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ë„ë©”ì¸ì— í¬í•¨ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ),
                // ì•ˆì „ì„ ìœ„í•´ ì²´í¬ ë¡œì§ì„ ë„£ì„ ìˆ˜ë„ ìˆìŒ. í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” íŒ¨í„´ì´ íŠ¹ì´í•˜ì—¬ ë°”ë¡œ ë³€í™˜.
                return `<a href="tel:${p1}${p2}${p3}" class="phone-link" style="color:#003366; text-decoration:underline;">${match}</a>`;
            });

            return result;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì½”ë”©ìš©ì–´ íƒ­ë§Œ ë¨¼ì € ë¶ˆëŸ¬ì˜¤ê¸° (ì„±ëŠ¥ ìµœì í™”)
        window.onload = function () {
            showLoading();
            fetchCurrentTabData();
        };

        // ë¡œë”© í‘œì‹œ
        function showLoading() {
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }

        // ë¡œë”© ìˆ¨ê¸°ê¸°
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }

        // í˜„ì¬ íƒ­ë§Œ ë¶ˆëŸ¬ì˜¤ê¸° (ì´ˆê¸° ë¡œë”© ì†ë„ ê°œì„ )
        function fetchCurrentTabData() {
            const url = `${API_URL}?action=load&sheetName=${currentSheet}&t=${new Date().getTime()}`;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    if (!cachedData) cachedData = {};
                    cachedData[currentSheet] = data;
                    renderCurrentSheet();
                    hideLoading();
                })
                .catch(err => {
                    console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
                    hideLoading();
                    alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });
        }

        // ì „ ì‹œíŠ¸ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ (ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”ìš©)
        function fetchAllData(callback) {
            const url = `${API_URL}?action=loadAll&t=${new Date().getTime()}`;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    // ì„œë²„ ì‘ë‹µ ê²€ì¦
                    if (data && data.status === 'error') {
                        throw new Error(data.message || 'ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜');
                    }

                    // loadAll ê²°ê³¼(ê°ì²´ í˜•íƒœ)ì¸ì§€ í™•ì¸
                    if (!data || typeof data !== 'object' || Array.isArray(data)) {
                        throw new Error('ì„œë²„ ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. (GASë¥¼ ìµœì‹  ì½”ë“œë¡œ ìˆ˜ì •í•˜ê³  [ìƒˆ ë°°í¬] í•˜ì…¨ë‚˜ìš”?)');
                    }

                    cachedData = data;
                    if (callback) callback();
                    else renderCurrentSheet();
                })
                .catch(err => {
                    console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
                    const container = document.getElementById('list-container'); // container ë³€ìˆ˜ ì„ ì–¸
                    if (container) {
                        container.innerHTML = `
                            <div style="text-align:center; color:#d9534f; padding:40px;">
                                <p><strong>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</strong></p>
                                <p style="font-size:13px; color:#666;">ì›ì¸: ${err.message}</p>
                                <p style="font-size:13px; color:#003366; cursor:pointer; text-decoration:underline;" onclick="fetchAllData()">[ë‹¤ì‹œ ì‹œë„í•˜ê¸°]</p>
                            </div>
                        `;
                    }
                });
        }

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchTab(sheetName) {
            currentSheet = sheetName;

            // íƒ­ í™œì„±í™” í‘œì‹œ
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(`tab-${sheetName.toLowerCase()}`).classList.add('active');

            // í•´ë‹¹ íƒ­ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¡œë”©
            if (!cachedData || !cachedData[sheetName]) {
                showLoading();
                fetchCurrentTabData();
            } else {
                renderCurrentSheet();
            }

            const termInput = document.getElementById('term');
            const termLabel = document.querySelector('.input-row .label'); // Specific selector for term label
            const descLabel = document.querySelectorAll('.input-row .label')[1]; // Specific selector for description label
            const descInput = document.getElementById('description');

            // ê¸°ë³¸ ì„¸ë¡œ ê¸¸ì´ (3ì¤„)ë¡œ ì´ˆê¸°í™”
            descInput.rows = 3;

            if (sheetName === 'Coding') {
                document.getElementById('tab-coding').classList.add('active');
                termInput.placeholder = 'ìš©ì–´ (ì˜ˆ: API, Variable)';
                termLabel.textContent = 'ìš©ì–´';
                descLabel.textContent = 'ìš©ì–´ ì„¤ëª…';
            } else if (sheetName === 'Prompt') {
                document.getElementById('tab-prompt').classList.add('active');
                termInput.placeholder = 'í”„ë¡¬í”„íŠ¸ (ì˜ˆ: ì‹œë¥¼ ì¨ì¤˜, ì½”ë“œ ë¦¬ë·°í•´ì¤˜)';
                termLabel.textContent = 'í”„ë¡¬í”„íŠ¸';
                descLabel.textContent = 'ìƒì„¸ ì„¤ëª…';
            } else if (sheetName === 'URL') {
                document.getElementById('tab-url').classList.add('active');
                termInput.placeholder = 'ì°¸ê³  ì œëª© (ì˜ˆ: ìœ ìš©í•œ ì‚¬ì´íŠ¸)';
                termLabel.textContent = 'ì°¸ê³  ì œëª©';
                descLabel.textContent = 'ì°¸ê³  URL/ì„¤ëª…';
            } else if (sheetName === 'Ideas') {
                document.getElementById('tab-ideas').classList.add('active');
                termInput.placeholder = 'ì•„ì´ë””ì–´ ì œëª© (ì˜ˆ: ì•± ê¸°íš ì•ˆ)';
                termLabel.textContent = 'ì•„ì´ë””ì–´ ì œëª©';
                descLabel.textContent = 'ì•„ì´ë””ì–´ ìƒì„¸ ë‚´ìš©';
            } else if (sheetName === 'Jungri') {
                document.getElementById('tab-jungri').classList.add('active');
                termInput.placeholder = 'ê°•ì˜ ì œëª© (ì˜ˆ: React ê¸°ì´ˆ ê°•ì˜)';
                termLabel.textContent = 'ê°•ì˜ ì œëª©';
                descLabel.textContent = 'ê°•ì˜ ì •ë¦¬';
                descInput.rows = 30; // ê°•ì˜ ì •ë¦¬ë„ ê¸¸ê²Œ
            } else if (sheetName === 'WorkProcess') {
                document.getElementById('tab-workprocess').classList.add('active');
                termInput.placeholder = 'ì‹¤ì „ ì œëª© (ì˜ˆ: í”„ë¡œì íŠ¸ ì§„í–‰ ê³¼ì •)';
                termLabel.textContent = 'ì‹¤ì „ ì œëª©';
                descLabel.textContent = 'ì‹¤ì „ ê³¼ì •';
                descInput.rows = 30; // ì‹¤ì „ ê³¼ì •ë„ ê¸¸ê²Œ
            } else if (sheetName === 'Customer') {
                document.getElementById('tab-customer').classList.add('active');
                termInput.placeholder = 'ì†ë‹˜ ì œëª© (ì˜ˆ: í™ê¸¸ë™)';
                termLabel.textContent = 'ì†ë‹˜ ì œëª©';
                descLabel.textContent = 'ì†ë‹˜ ë‚´ìš©';
                descInput.rows = 30; // ì†ë‹˜ ë‚´ìš©ë„ ê¸¸ê²Œ
            } else if (sheetName === 'Visit') {
                document.getElementById('tab-visit').classList.add('active');
                termInput.placeholder = 'ë°©ë¬¸ ì¼ì • (ì˜ˆ: 2024-01-01)';
                termLabel.textContent = 'ë°©ë¬¸ ì¼ì •';
                descLabel.textContent = 'ë°©ë¬¸ ë‚´ìš©';
                descInput.rows = 30; // ë°©ë¬¸ ë‚´ìš©ë„ ê¸¸ê²Œ
            } else if (sheetName === 'ItemDetail') {
                document.getElementById('tab-itemdetail').classList.add('active');
                termInput.placeholder = 'ë¬¼ê±´ ì´ë¦„ (ì˜ˆ: ëƒ‰ì¥ê³ )';
                termLabel.textContent = 'ë¬¼ê±´ ì´ë¦„';
                descLabel.textContent = 'ì„¸ë¶€ ì‚¬í•­';
                descInput.rows = 30; // ë¬¼ê±´ ì„¸ë¶€ ì‚¬í•­ë„ ê¸¸ê²Œ
            } else if (sheetName === 'Private') {
                document.getElementById('tab-private').classList.add('active');
                termInput.placeholder = 'ìë£Œ ì œëª© (ì˜ˆ: ë¹„ë°€ë²ˆí˜¸)';
                termLabel.textContent = 'ìë£Œ ì œëª©';
                descLabel.textContent = 'ìë£Œ ë‚´ìš©';
                descInput.rows = 30; // ê°œì¸ ìë£Œë„ ê¸¸ê²Œ
            }

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('term').value = '';
            document.getElementById('description').value = '';

            // ë Œë”ë§ì€ ìœ„ì—ì„œ ì´ë¯¸ ë¶„ê¸° ì²˜ë¦¬ë˜ì—ˆìœ¼ë¯€ë¡œ ì¤‘ë³µ í˜¸ì¶œ ì œê±°
            // (ìƒë‹¨ if/else ë¸”ë¡ì—ì„œ ì´ë¯¸ ì²˜ë¦¬ë¨)
        }

        // ì¸ë¼ì¸ ìˆ˜ì • ëª¨ë“œ í† ê¸€
        function toggleInlineEdit(id) {
            const card = document.querySelector(`.card[data-id="${id}"]`);
            const isEditing = card.classList.contains('editing');

            if (isEditing) {
                // ìˆ˜ì • ì·¨ì†Œ (ìºì‹œì—ì„œ ì›ë³¸ ë°ì´í„° ë³µì›)
                const id = card.getAttribute('data-id');
                if (cachedData && cachedData[currentSheet]) {
                    const item = cachedData[currentSheet].find(item => String(item.id) === String(id));
                    if (item) {
                        const termDiv = card.querySelector('.card-term');
                        const descDiv = card.querySelector('.card-desc');
                        termDiv.textContent = item.term;

                        // ê°•ì˜ì •ë¦¬/ì‹¤ì „ê³¼ì •/ê°œì¸ìë£Œ/ì†ë‹˜/ë°©ë¬¸/ë¬¼ê±´ì€ ì ‘ê¸°/í¼ì¹˜ê¸° êµ¬ì¡° ë³µì›
                        const isLecture = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);
                        const description = linkify(item.description);
                        const descriptionText = String(item.description || '');
                        const lines = descriptionText.split('\n');
                        const isLongContent = lines.length > 1;

                        if (isLecture && isLongContent) {
                            // ë¶€ëª¨ div ì°¾ê¸°
                            const parentDiv = descDiv.parentElement;
                            parentDiv.innerHTML = `
                                <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                                <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                            `;
                        } else {
                            descDiv.innerHTML = description;
                        }

                        const actionsDiv = card.querySelector('.card-actions');
                        actionsDiv.innerHTML = `<button class="edit-btn" onclick="toggleInlineEdit('${id}')">ìˆ˜ì •</button>`;
                        card.classList.remove('editing');
                    }
                }
            } else {
                // ë‹¤ë¥¸ ëª¨ë“  ìˆ˜ì • ëª¨ë“œ í•´ì œ (ë™ì‹œ ìˆ˜ì • ë°©ì§€)
                document.querySelectorAll('.card.editing').forEach(c => c.classList.remove('editing'));

                // ìˆ˜ì • ëª¨ë“œ í•´ì œ ì‹œì—ëŠ” ìºì‹œëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì‹œ ê·¸ë¦¬ëŠ” ê²ƒì´ ì•ˆì „í•¨
                // í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœ í† ê¸€ì´ë¯€ë¡œ ìš”ì†Œë¥¼ ì°¾ëŠ”ë° ì§‘ì¤‘

                // 1. ë§Œì•½ ì´ë¯¸ ìˆ˜ì • ì¤‘ì´ì—ˆë‹¤ë©´ (ì·¨ì†Œ ë²„íŠ¼ í´ë¦­), ì›ë˜ ë·°ë¡œ ë³µêµ¬í•´ì•¼ í•¨
                // ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ í•´ë‹¹ ì¹´ë“œë¥¼ ìºì‹œ ë°ì´í„°ë¡œ ë‹¤ì‹œ ë Œë”ë§í•˜ëŠ” ê²ƒ
                if (card.classList.contains('editing')) {
                    const item = cachedData[currentSheet].find(i => String(i.id) === String(id));
                    if (item) {
                        // ì¹´ë“œ ë‚´ìš© ì „ì²´ë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ê¸° (ì ‘ê¸°/í¼ì¹˜ê¸° ìƒíƒœ ì´ˆê¸°í™”ë¨)
                        // ê¸°ì¡´ ì¹´ë“œ êµì²´ ë°©ì‹
                        const tempContainer = document.createElement('div');

                        // ì¹´ë“œ ë‚´ìš© ì¬êµ¬ì„± (renderCurrentSheet ë¡œì§ ì¼ë¶€ ì¬ì‚¬ìš©)
                        const isLecture = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);
                        const description = linkify(item.description);
                        const descriptionText = String(item.description || '');
                        const lines = descriptionText.split('\n');
                        const isLongContent = lines.length > 1;

                        let descHtml = '';
                        if (isLecture && isLongContent) {
                            descHtml = `
                                <div>
                                    <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                                    <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                                </div>
                            `;
                        } else {
                            descHtml = `<div class="card-desc">${description}</div>`;
                        }

                        card.innerHTML = `
                            <input type="checkbox" class="chk-box" data-id="${item.id}">
                            <div class="card-content">
                                <div class="card-term">${item.term}</div>
                                ${descHtml}
                            </div>
                            <div class="card-actions">
                                <button class="edit-btn" onclick="toggleInlineEdit('${item.id}')">ìˆ˜ì •</button>
                            </div>`;

                        card.classList.remove('editing');
                        return; // í•¨ìˆ˜ ì¢…ë£Œ
                    }
                }

                // --- ìˆ˜ì • ëª¨ë“œ ì§„ì… ë¡œì§ ---

                const termDiv = card.querySelector('.card-term');
                let descDiv = card.querySelector('.card-desc');
                const currentTerm = termDiv.textContent;

                // ê°•ì˜ì •ë¦¬/ì‹¤ì „ê³¼ì •ì˜ ê²½ìš° descDivê°€ ë¶€ëª¨ div ì•ˆì— ìˆì„ ìˆ˜ ìˆìŒ
                let descParent = null;
                let currentDescText = '';
                if (!descDiv) {
                    // descDivë¥¼ ì°¾ì§€ ëª»í•œ ê²½ìš°, card-content ë‚´ë¶€ì—ì„œ ì°¾ê¸°
                    const cardContent = card.querySelector('.card-content');
                    descDiv = cardContent.querySelector('.card-desc');
                    if (descDiv) {
                        descParent = descDiv.parentElement;
                        currentDescText = descDiv.textContent; // í…ìŠ¤íŠ¸ ì €ì¥
                    }
                } else {
                    // descDivëŠ” ìˆì§€ë§Œ ë¶€ëª¨ê°€ card-contentê°€ ì•„ë‹Œ ê²½ìš° (wrapper ì¡´ì¬)
                    if (descDiv.parentElement && !descDiv.parentElement.classList.contains('card-content')) {
                        descParent = descDiv.parentElement;
                    }
                    currentDescText = descDiv.textContent;
                }

                // card-desc ìš”ì†Œë¥¼ ì°¾ì§€ ëª»í–ˆë‹¤ë©´ (ì´ë¯¸ ìˆ˜ì • ëª¨ë“œì´ê±°ë‚˜ êµ¬ì¡° ë¬¸ì œ) ë¦¬í„´
                if (!descDiv && !descParent) {
                    console.error("ì„¤ëª… ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }

                const currentDesc = currentDescText || (descDiv ? descDiv.textContent : '');

                card.classList.add('editing');

                // ëª¨ë“  ì¹´í…Œê³ ë¦¬ì—ì„œ ì œëª©ì„ textareaë¡œ í‘œì‹œ (ê¸´ ì œëª© ì§€ì› ë° ì „ì²´ í‘œì‹œ)
                // ëª¨ë“  ì¹´í…Œê³ ë¦¬ì—ì„œ ì œëª©ì„ textareaë¡œ í‘œì‹œ (ê¸´ ì œëª© ì§€ì› ë° ì „ì²´ í‘œì‹œ)
                // ì´ˆê¸°ì—ëŠ” rowsë¥¼ ì ë‹¹íˆ ì£¼ê³ , ë Œë”ë§ í›„ scrollHeightë¡œ ìë™ ì¡°ì ˆ
                // styleì— white-space: pre-wrap; word-break: break-word; ì¶”ê°€í•˜ì—¬ ì¤„ë°”ê¿ˆ ê°•ì œ
                termDiv.innerHTML = `<textarea class="inline-textarea" rows="1" style="overflow-y:hidden; resize:none; white-space: pre-wrap; word-break: break-word;">${currentTerm}</textarea>`;

                // ë‚´ìš© ìˆ˜ì • ì°½ë„ ë™ì¼í•˜ê²Œ ì²˜ë¦¬
                // descParentê°€ ìˆìœ¼ë©´ (ì ‘ê¸°/í¼ì¹˜ê¸° êµ¬ì¡°) ì „ì²´ë¥¼ textareaë¡œ êµì²´í•˜ë˜, ë‚˜ì¤‘ì— ë³µì›ì„ ìœ„í•´ ì‹ë³„ì ìœ ì§€
                if (descParent) {
                    descParent.innerHTML = `<textarea class="inline-textarea card-desc-edit" rows="1" style="overflow-y:hidden; resize:none; white-space: pre-wrap; word-break: break-word;">${currentDesc}</textarea>`;
                } else {
                    descDiv.innerHTML = `<textarea class="inline-textarea" rows="1" style="overflow-y:hidden; resize:none; white-space: pre-wrap; word-break: break-word;">${currentDesc}</textarea>`;
                }

                const actionsDiv = card.querySelector('.card-actions');
                actionsDiv.innerHTML = `
                    <button class="inline-cancel-btn" onclick="toggleInlineEdit('${id}')">ì·¨ì†Œ</button>
                    <button class="inline-save-btn" onclick="saveInlineEdit('${id}')">ì €ì¥</button>
                `;

                // ìë™ ë†’ì´ ì¡°ì ˆ í•¨ìˆ˜
                const autoResize = (el) => {
                    el.style.height = 'auto'; // ë†’ì´ ì´ˆê¸°í™” í›„ ì¬ê³„ì‚°
                    el.style.height = (el.scrollHeight + 2) + 'px'; // +2px ì—¬ìœ 
                };

                // ìƒì„±ëœ textareaë“¤ì— ëŒ€í•´ ë†’ì´ ìë™ ì¡°ì ˆ ì ìš©
                const editFields = card.querySelectorAll('.inline-textarea');

                // ë Œë”ë§ í›„ ë†’ì´ë¥¼ ê³„ì‚°í•˜ë„ë¡ ì¶©ë¶„í•œ ì§€ì—° ì‹œê°„ ë¶€ì—¬
                setTimeout(() => {
                    editFields.forEach(field => {
                        autoResize(field);
                    });
                }, 50); // ì§€ì—° ì‹œê°„ì„ 50msë¡œ ì¦ê°€

                editFields.forEach(field => {
                    // ì…ë ¥ ì‹œ ìë™ ì¡°ì ˆ
                    field.addEventListener('input', function () {
                        autoResize(this);
                    });

                    // í¬ì»¤ìŠ¤ ì‹œ ìë™ ìŠ¤í¬ë¡¤ ë°©ì§€
                    field.addEventListener('focus', function (e) {
                        const scrollY = window.scrollY;
                        setTimeout(() => {
                            window.scrollTo(0, scrollY);
                        }, 0);
                    }, { once: true });
                });
            }
        }

        // ì¸ë¼ì¸ ìˆ˜ì • ì €ì¥
        function saveInlineEdit(id) {
            const card = document.querySelector(`.card[data-id="${id}"]`);

            // ì œëª©ì€ textarea (ì¸ë¼ì¸ ìˆ˜ì • ëª¨ë“œ)
            const termTextarea = card.querySelector('.card-term .inline-textarea');
            const term = termTextarea ? termTextarea.value.trim() : '';

            // ë‚´ìš©ì€ ë‘ ë²ˆì§¸ textarea ì°¾ê¸° (card-desc í´ë˜ìŠ¤ê°€ ìˆ˜ì • ëª¨ë“œì—ì„œ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ)
            // ì²« ë²ˆì§¸ëŠ” ì œëª©, ë‘ ë²ˆì§¸ëŠ” ë‚´ìš©
            const allTextareas = card.querySelectorAll('.inline-textarea');
            let description = '';
            if (allTextareas.length >= 2 && allTextareas[1]) {
                description = allTextareas[1].value.trim();
            } else {
                // ê¸°ì¡´ ë°©ì‹ ì‹œë„
                const descInput = card.querySelector('.inline-textarea.card-desc-edit') || card.querySelector('.card-desc .inline-textarea');
                description = descInput ? descInput.value.trim() : '';
            }

            if (!term || !description) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì¦‰ì‹œ ìºì‹œ ë°ì´í„° ì—…ë°ì´íŠ¸ (ì†ë„ ê°œì„ )
            if (cachedData && cachedData[currentSheet]) {
                const itemIndex = cachedData[currentSheet].findIndex(item => String(item.id) === String(id));
                if (itemIndex !== -1) {
                    cachedData[currentSheet][itemIndex].term = term;
                    cachedData[currentSheet][itemIndex].description = description;
                }
            }

            // ìºì‹œì—ì„œ ë°ì´í„° ì°¾ê¸°
            const item = cachedData[currentSheet].find(i => String(i.id) === String(id));
            if (!item) {
                alert('ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ì¹´ë“œ ì „ì²´ë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ê¸° (ê°€ì¥ ì•ˆì „í•œ ë°©ë²•)
            const isLecture = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);
            const linkedDescription = linkify(description);
            const descriptionText = String(description || '');
            const lines = descriptionText.split('\n');
            const isLongContent = lines.length > 1;

            let descHtml = '';
            if (isLecture && isLongContent) {
                descHtml = `
                    <div>
                        <div class="card-desc collapsed" id="desc-${id}">${linkedDescription}</div>
                        <button class="toggle-btn" onclick="toggleContent('${id}')">ë”ë³´ê¸° â–¼</button>
                    </div>
                `;
            } else {
                descHtml = `<div class="card-desc">${linkedDescription}</div>`;
            }

            card.innerHTML = `
                <input type="checkbox" class="chk-box" data-id="${id}">
                <div class="card-content">
                    <div class="card-term">${term}</div>
                    ${descHtml}
                </div>
                <div class="card-actions">
                    <button class="edit-btn" onclick="toggleInlineEdit('${id}')">ìˆ˜ì •</button>
                </div>`;

            card.classList.remove('editing');

            // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì„œë²„ ë™ê¸°í™”
            const params = new URLSearchParams();
            params.append('action', 'update');
            params.append('id', id);
            params.append('term', term);
            params.append('description', description);
            params.append('sheetName', currentSheet);

            fetch(API_URL, {
                method: 'POST',
                mode: 'no-cors',
                body: params
            })
                .then(() => {
                    // ì„œë²„ ë™ê¸°í™” ì™„ë£Œ (UIëŠ” ì´ë¯¸ ì—…ë°ì´íŠ¸ë¨)
                })
                .catch(err => {
                    console.error('ì˜¤ë¥˜:', err);
                    alert('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });     // ê¸°ì¡´ ìƒë‹¨ ìˆ˜ì • í•¨ìˆ˜ëŠ” ì œê±°í•˜ê±°ë‚˜ í˜¸í™˜ì„±ì„ ìœ„í•´ ìœ ì§€ (ì—¬ê¸°ì„œëŠ” ì¸ë¼ì¸ ì „ìš©ìœ¼ë¡œ ì „í™˜í•˜ë¯€ë¡œ ë¯¸ì‚¬ìš©)
        }

        function enterEditMode(id, term, description) {
            toggleInlineEdit(id);
        }

        function cancelEdit() {
            // ìƒë‹¨ ì…ë ¥ì°½ ì´ˆê¸°í™” ìš©ë„ë¡œë§Œ ì‚¬ìš©
            document.getElementById('term').value = '';
            document.getElementById('description').value = '';
        }

        // ë°ì´í„° ì €ì¥ (ìƒˆ ë°ì´í„° ë“±ë¡ ì „ìš©)
        function saveData() {
            console.log('saveData í˜¸ì¶œë¨, í˜„ì¬ ì‹œíŠ¸:', currentSheet);
            const term = document.getElementById('term').value.trim();
            const description = document.getElementById('description').value.trim();

            if (!term || !description) {
                let typeName = 'ë°ì´í„°';
                if (currentSheet === 'Coding') typeName = 'ìš©ì–´';
                else if (currentSheet === 'Prompt') typeName = 'í”„ë¡¬í”„íŠ¸';
                else if (currentSheet === 'URL') typeName = 'ì°¸ê³  ì œëª©';
                else if (currentSheet === 'Ideas') typeName = 'ì•„ì´ë””ì–´ ì œëª©';
                else if (currentSheet === 'WorkProcess') typeName = 'ì‹¤ì „ ì œëª©';
                else if (currentSheet === 'Jungri') typeName = 'ê°•ì˜ ì œëª©';
                else if (currentSheet === 'Customer') typeName = 'ì†ë‹˜ ì œëª©';
                else if (currentSheet === 'Visit') typeName = 'ë°©ë¬¸ ì¼ì •';
                else if (currentSheet === 'ItemDetail') typeName = 'ë¬¼ê±´ ì´ë¦„';
                else if (currentSheet === 'Private') typeName = 'ìë£Œ ì œëª©';

                alert(`${typeName}ì™€ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
                return;
            }

            // ì„ì‹œ ID ìƒì„± (ì„œë²„ì—ì„œ ì‹¤ì œ IDë¥¼ ë°›ì„ ë•Œê¹Œì§€ ì‚¬ìš©)
            const tempId = 'temp_' + Date.now();

            // ì¦‰ì‹œ UIì— ì¶”ê°€ (ì†ë„ ê°œì„ )
            const newItem = {
                id: tempId,
                term: term,
                description: description
            };

            // ìºì‹œì— ì¶”ê°€
            if (cachedData && cachedData[currentSheet]) {
                cachedData[currentSheet].unshift(newItem); // ìµœì‹  í•­ëª©ì´ ë§¨ ìœ„ë¡œ ì˜¤ë„ë¡ unshift ì‚¬ìš©
            }

            // UIì— ì¦‰ì‹œ í‘œì‹œ
            addCardToUI(newItem);

            // ì…ë ¥ í¼ ì´ˆê¸°í™”
            cancelEdit();

            // ëª¨ë“  ì¹´í…Œê³ ë¦¬ë¥¼ ì•ˆì „í•œ POST ë°©ì‹ìœ¼ë¡œ ì „ì†¡ (CORS ì˜¤ë¥˜ ë°©ì§€)
            const params = new URLSearchParams();
            params.append('action', 'save');
            params.append('term', term);
            params.append('description', description);
            params.append('sheetName', currentSheet);

            fetch(API_URL, {
                method: 'POST',
                mode: 'no-cors',
                body: params
            })
                .then(() => {
                    // ì„œë²„ ë™ê¸°í™” ì™„ë£Œ (UIëŠ” ì´ë¯¸ ì—…ë°ì´íŠ¸ë¨)
                    console.log('ë°±ê·¸ë¼ìš´ë“œ ì €ì¥ ì™„ë£Œ');
                })
                .catch(err => {
                    console.error('ì˜¤ë¥˜:', err);
                    // ì˜¤ë¥˜ ì‹œ ì„ì‹œ í•­ëª© ì œê±°
                    const tempCard = document.querySelector(`.card[data-id="${tempId}"]`);
                    if (tempCard) tempCard.remove();
                    alert('ì €ì¥ ì¤‘ ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ë°ì´í„°ê°€ ì €ì¥ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤)');
                });
        }

        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€ ë° ë Œë”ë§ í˜¸ì¶œ)
        function loadData(sortType) {
            currentSort = sortType;
            if (cachedData) {
                renderCurrentSheet();
            } else {
                fetchAllData();
            }
        }

        // UIì— ì¹´ë“œ ì¦‰ì‹œ ì¶”ê°€í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function addCardToUI(item) {
            const container = document.getElementById('list-container');

            // ì•ˆì „ì¥ì¹˜: containerê°€ ì—†ìœ¼ë©´ ì˜¤ë¥˜ ë°©ì§€
            if (!container) {
                console.error('list-container ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }

            const card = document.createElement('div');
            card.className = 'card';
            card.setAttribute('data-id', item.id);

            const isLecture = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);
            const description = linkify(item.description);
            const descriptionText = String(item.description || '');
            const lines = descriptionText.split('\n');
            const isLongContent = lines.length > 1;

            let descHtml = '';
            if (isLecture && isLongContent) {
                descHtml = `
                    <div>
                        <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                        <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                    </div>
                `;
            } else {
                descHtml = `<div class="card-desc">${description}</div>`;
            }

            card.innerHTML = `
                <input type="checkbox" class="chk-box" data-id="${item.id}">
                <div class="card-content">
                    <div class="card-term">${item.term}</div>
                    ${descHtml}
                </div>
                <div class="card-actions">
                    <button class="edit-btn" onclick="toggleInlineEdit('${item.id}')">ìˆ˜ì •</button>
                </div>`;

            // ìµœì‹  í•­ëª©ì´ ë§¨ ìœ„ì— ì˜¤ë„ë¡ prepend
            container.prepend(card);
        }

        // í˜„ì¬ ì‹œíŠ¸ ë°ì´í„° ë Œë”ë§ (ì‹¤ì œ í™”ë©´ ì¶œë ¥ ë¡œì§)
        function renderCurrentSheet() {
            const container = document.getElementById('list-container');
            if (!cachedData) return;

            const data = [...(cachedData[currentSheet] || [])];

            // ì •ë ¬ ë²„íŠ¼ í™œì„±í™” í‘œì‹œ
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            if (currentSort === 'newest') document.getElementById('btn-newest').classList.add('active');
            if (currentSort === 'alphabet') document.getElementById('btn-alphabet').classList.add('active');
            if (currentSort === 'custom') document.getElementById('btn-custom').classList.add('active');

            container.innerHTML = ''; // ì´ˆê¸°í™”

            if (data.length === 0) {
                let typeName = 'ë°ì´í„°';
                if (currentSheet === 'Coding') typeName = 'ìš©ì–´';
                else if (currentSheet === 'Prompt') typeName = 'í”„ë¡¬í”„íŠ¸';
                else if (currentSheet === 'URL') typeName = 'ì°¸ê³  ë‚´ìš©';
                else if (currentSheet === 'Ideas') typeName = 'ì•„ì´ë””ì–´';
                else if (currentSheet === 'WorkProcess') typeName = 'ì‹¤ì „ ê³¼ì •';
                else if (currentSheet === 'Jungri') typeName = 'ê°•ì˜ ì •ë¦¬';
                else if (currentSheet === 'Customer') typeName = 'ì†ë‹˜ ë‚´ìš©';
                else if (currentSheet === 'Visit') typeName = 'ë°©ë¬¸ ë°ì´í„°';
                else if (currentSheet === 'ItemDetail') typeName = 'ë¬¼ê±´ ë°ì´í„°';
                else if (currentSheet === 'Private') typeName = 'ê°œì¸ ìë£Œ';

                container.innerHTML = `<p style="text-align:center; color:#999; padding:40px;">ë“±ë¡ëœ ${typeName}ê°€ ì—†ìŠµë‹ˆë‹¤. ì²« ë°ì´í„°ë¥¼ ë“±ë¡í•´ë³´ì„¸ìš”!</p>`;
                return;
            }

            // ì •ë ¬ ì ìš©
            if (currentSort === 'newest') {
                data.sort((a, b) => b.id - a.id);
            } else if (currentSort === 'alphabet') {
                data.sort((a, b) => String(a.term).localeCompare(String(b.term), 'ko'));
            }

            data.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.setAttribute('data-id', item.id);

                // ê°•ì˜ì •ë¦¬/ì‘ì—…ê³¼ì •/ê°œì¸ìë£Œ/ì†ë‹˜/ë°©ë¬¸/ë¬¼ê±´ ì¹´í…Œê³ ë¦¬ì´ê³  ë‚´ìš©ì´ ê¸´ ê²½ìš° ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼ ì¶”ê°€
                const isLecture = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);
                const description = linkify(item.description);
                // descriptionì„ ë¬¸ìì—´ë¡œ ë³€í™˜ í›„ split ì‚¬ìš© (ì•ˆì „ì„± í™•ë³´)
                const descriptionText = String(item.description || '');
                const lines = descriptionText.split('\n');
                const isLongContent = lines.length > 1;

                let descHtml = '';
                if (isLecture && isLongContent) {
                    descHtml = `
                        <div>
                            <div class="card-desc collapsed" id="desc-${item.id}">${description}</div>
                            <button class="toggle-btn" onclick="toggleContent('${item.id}')">ë”ë³´ê¸° â–¼</button>
                        </div>
                    `;
                } else {
                    descHtml = `<div class="card-desc">${description}</div>`;
                }

                card.innerHTML = `
                    <input type="checkbox" class="chk-box" data-id="${item.id}">
                    <div class="card-content">
                        <div class="card-term">${item.term}</div>
                        ${descHtml}
                    </div>
                    <div class="card-actions">
                        <button class="edit-btn" onclick="toggleInlineEdit('${item.id}')">ìˆ˜ì •</button>
                    </div>`;
                container.appendChild(card);
            });
        }

        // ê°•ì˜ ë‚´ìš© ì ‘ê¸°/í¼ì¹˜ê¸° í† ê¸€
        function toggleContent(id) {
            const descElement = document.getElementById(`desc-${id}`);
            const button = event.target;

            if (descElement.classList.contains('collapsed')) {
                descElement.classList.remove('collapsed');
                button.textContent = 'ì ‘ê¸° â–²';
            } else {
                descElement.classList.add('collapsed');
                button.textContent = 'ë”ë³´ê¸° â–¼';
            }
        }

        // ì •ë ¬ ë³€ê²½ (ì„œë²„ í˜¸ì¶œ ì—†ì´ ì¦‰ì‹œ ë°˜ì˜)
        function changeSort(sortType) {
            currentSort = sortType;
            renderCurrentSheet();
        }

        // ë°ì´í„° ìˆœì„œ ë³€ê²½ (í–‰ ì´ë™)
        function reorderItem(direction) {
            const checkboxes = document.querySelectorAll('.chk-box:checked');
            if (checkboxes.length !== 1) {
                alert('ìˆœì„œë¥¼ ë³€ê²½í•  í•­ëª©ì„ 1ê°œë§Œ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì •ë ¬ ëª¨ë“œê°€ 'custom'(ì…ë ¥ìˆœ)ì´ ì•„ë‹ˆë©´ ê²½ê³  í›„ ì „í™˜ ë˜ëŠ” ìë™ ì „í™˜
            if (currentSort !== 'custom') {
                if (confirm("ìˆœì„œ ë³€ê²½ì„ ìœ„í•´ 'ì…ë ¥ìˆœ' ë³´ê¸°ë¡œ ì „í™˜í•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                    changeSort('custom');
                } else {
                    return;
                }
            }

            const id = checkboxes[0].dataset.id;
            const data = cachedData[currentSheet];
            const index = data.findIndex(item => String(item.id) === String(id));

            if (index === -1) return;

            // ë¡œì»¬ ë°°ì—´ì—ì„œ ì´ë™ (ì¦‰ì‹œ UI ë°˜ì‘)
            // ì£¼ì˜: dataëŠ” ì‹œíŠ¸ ìˆœì„œ(ì˜¤ë˜ëœ ìˆœ) ê·¸ëŒ€ë¡œë¼ê³  ê°€ì •.
            // direction: top(ë§¨ìœ„=ì¸ë±ìŠ¤0), bottom(ë§¨ì•„ë˜), up(ì¸ë±ìŠ¤-1), down(ì¸ë±ìŠ¤+1)

            // ìœ íš¨ì„± ì²´í¬ ë° ì´ë™
            // 'up'ì€ ì¸ë±ìŠ¤ê°€ ì‘ì•„ì§€ëŠ” ë°©í–¥(0ìª½ìœ¼ë¡œ), 'down'ì€ ì»¤ì§€ëŠ” ë°©í–¥
            let targetIndex;
            if (direction === 'top') {
                targetIndex = 0;
            } else if (direction === 'bottom') {
                targetIndex = data.length - 1;
            } else if (direction === 'up') {
                targetIndex = index - 1;
            } else if (direction === 'down') {
                targetIndex = index + 1;
            }

            if (targetIndex < 0 || targetIndex >= data.length || targetIndex === index) {
                alert('ë” ì´ìƒ ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ë°°ì—´ ë‚´ ì´ë™
            const item = data.splice(index, 1)[0];
            // top, bottomì¼ ë•Œ spliceê°€ ì¢€ ë‹¤ë¦„.
            // ìœ„ì—ì„œ targetIndexë¥¼ ì´ë¯¸ ê³„ì‚°í–ˆì§€ë§Œ, spliceë¡œ ë¹¼ë‚¸ í›„ì—ëŠ” ì¸ë±ìŠ¤ê°€ ë°€ë¦´ ìˆ˜ ìˆìŒ.
            // insertAt ë¡œì§ì„ ì¨ì•¼ í•¨.

            // ë‹¤ì‹œ ê³„ì‚°:
            // 1. ë¹¼ê¸° (remove)
            // itemì€ ì´ë¯¸ íšë“ë¨. data ê¸¸ì´ëŠ” 1 ì¤„ì–´ë“¦.

            // 2. ë„£ê¸° (insert)
            // top -> 0
            // bottom -> data.length (ë§¨ ë’¤)
            // up -> index - 1 (ì›ë˜ ìœ„ì¹˜ë³´ë‹¤ í•˜ë‚˜ ì•)
            // down -> index (ì›ë˜ ìœ„ì¹˜ì—ì„œ í•˜ë‚˜ ë¹ ì¡Œìœ¼ë‹ˆ, ì›ë˜ ìœ„ì¹˜ê°€ ê³§ ë‹¤ìŒ ì¹¸ì´ì—ˆë˜ ê³³ì˜ ì¸ë±ìŠ¤ê°€ ë¨... í—·ê°ˆë¦¼)
            // ì˜ˆ: [0, 1, 2, 3], 1ë²ˆì„ down -> [0, 2, 3], ë„£ì„ ìœ„ì¹˜ 2 -> [0, 2, 1, 3] (OK)

            // ì¬ì •ë¦¬:
            // ì´ë¯¸ splice(index, 1) í–ˆìœ¼ë¯€ë¡œ
            // up: index - 1 (indexê°€ 0ì´ë©´ ë¶ˆê°€)
            // down: index (indexê°€ lastë©´ spliceí›„ lengthì™€ ê°™ìŒ -> append)

            // ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ìœ„/ì•„ë˜ë§Œ ì¬ê³„ì‚°
            if (direction === 'up') {
                targetIndex = index - 1;
            } else if (direction === 'down') {
                targetIndex = index; // ì›ë˜ ì¸ë±ìŠ¤ ìë¦¬ì— ë„£ìœ¼ë©´, ì›ë˜ item ë’¤ì— ìˆë˜ ì• ê°€ ì•ìœ¼ë¡œ ë‹¹ê²¨ì¡Œìœ¼ë¯€ë¡œ ê·¸ ë’¤(ì›ë˜ ìë¦¬)ì— ë“¤ì–´ê°
            } else if (direction === 'top') {
                targetIndex = 0;
            } else if (direction === 'bottom') {
                targetIndex = data.length;
            }

            data.splice(targetIndex, 0, item);

            // UI ê°±ì‹ 
            renderCurrentSheet();

            // ì„œë²„ ë™ê¸°í™”
            fetch(`${API_URL}?action=reorder&id=${id}&direction=${direction}&sheetName=${currentSheet}`)
                .then(res => res.json())
                .then(result => {
                    if (result.status !== 'success') {
                        // ì‹¤íŒ¨ ì‹œ ë¡¤ë°±? ë³µì¡í•˜ë¯€ë¡œ ì•Œë¦¼ë§Œ
                        console.error(result.message);
                        alert('ì„œë²„ ì €ì¥ ì‹¤íŒ¨: ' + result.message);
                    }
                });
        }

        // ì „ì²´ ì„ íƒ / í•´ì œ
        function toggleSelectAll() {
            const checkboxes = document.querySelectorAll('.chk-box');
            if (checkboxes.length === 0) return;

            // í•˜ë‚˜ë¼ë„ ì²´í¬ê°€ ì•ˆ ëœ ê²ƒì´ ìˆìœ¼ë©´ ì „ì²´ ì„ íƒ, ëª¨ë‘ ì²´í¬ë˜ì–´ ìˆìœ¼ë©´ ì „ì²´ í•´ì œ
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);

            checkboxes.forEach(cb => {
                cb.checked = !allChecked;
            });
        }

        // ì„ íƒ ì‚­ì œ
        function deleteSelected() {
            const checkboxes = document.querySelectorAll('.chk-box:checked');
            if (checkboxes.length === 0) {
                alert('ì‚­ì œí•  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!confirm(`ì„ íƒí•œ ${checkboxes.length}ê°œ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }

            const ids = Array.from(checkboxes).map(cb => cb.dataset.id);

            // ì¦‰ì‹œ UIì—ì„œ ì œê±° (ì†ë„ ê°œì„ )
            ids.forEach(id => {
                const card = document.querySelector(`.card[data-id="${id}"]`);
                if (card) card.remove();
            });

            // ìºì‹œëœ ë°ì´í„°ì—ì„œë„ ì œê±°
            if (cachedData && cachedData[currentSheet]) {
                cachedData[currentSheet] = cachedData[currentSheet].filter(item => !ids.includes(String(item.id)));
            }

            // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì„œë²„ ë™ê¸°í™”
            const url = `${API_URL}?action=delete&ids=${ids.join(',')}&sheetName=${currentSheet}`;

            fetch(url)
                .then(res => res.json())
                .then(result => {
                    if (result.status !== 'success') {
                        // ì‹¤íŒ¨ ì‹œ ê²½ê³ 
                        alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ìƒˆë¡œê³ ì¹¨ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤)');
                    }
                })
                .catch(err => {
                    console.error('ì‚­ì œ ì˜¤ë¥˜:', err);
                    alert('ì‚­ì œ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });   // ì„ íƒ ì´ë™
        }
        function moveSelected() {
            const checkboxes = document.querySelectorAll('.chk-box:checked');
            if (checkboxes.length === 0) {
                alert('ì´ë™í•  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // í™•ì¥í˜•(ê°•ì˜ì •ë¦¬ ë“±)ì€ ê¸°ë³¸í˜•ê³¼ í¼ êµ¬ì¡°ê°€ ë‹¬ë¼ ì´ë™ ë¶ˆê°€ (ì„œë¡œ í˜¸í™˜ë˜ëŠ” ê²ƒë¼ë¦¬ëŠ” ê°€ëŠ¥í•˜ì§€ë§Œ ë³µì¡ë„ ì¤„ì´ê¸° ìœ„í•´ ì œí•œ)
            const isExtendedForm = ['Jungri', 'WorkProcess', 'Private', 'Customer', 'Visit', 'ItemDetail'].includes(currentSheet);

            if (isExtendedForm) {
                alert('ì´ ì¹´í…Œê³ ë¦¬(í™•ì¥í˜•)ì˜ í•­ëª©ì€ ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ëª¨ë‹¬ ì—´ê¸°
            window.selectedCheckboxes = checkboxes;
            showMoveModal();

        }

        // ëª¨ë‹¬ ì—´ê¸°
        function showMoveModal() {
            const modal = document.getElementById('moveModal');
            const buttonsContainer = document.getElementById('categoryButtons');

            // ë²„íŠ¼ ìƒì„± (ê°•ì˜ì •ë¦¬ ì œì™¸)
            const categories = [
                { name: 'Coding', label: 'Codingìš©ì–´' },
                { name: 'Prompt', label: 'í”„ë¡¬í”„íŠ¸' },
                { name: 'URL', label: 'ì°¸ê³ URL' },
                { name: 'Ideas', label: 'ì•„ì´ë””ì–´' },
                { name: 'WorkProcess', label: 'ì‹¤ì „ê³¼ì •' },
                { name: 'Jungri', label: 'ê°•ì˜ì •ë¦¬' },
                { name: 'Customer', label: 'ì†ë‹˜ë‚´ìš©' },
                { name: 'Visit', label: 'ë°©ë¬¸ì˜ˆì •' },
                { name: 'ItemDetail', label: 'ë¬¼ê±´ì„¸ë¶€' },
                { name: 'Private', label: 'ê°œì¸ìë£Œ' }
            ];

            buttonsContainer.innerHTML = '';
            categories.forEach(cat => {
                if (cat.name !== currentSheet) {
                    const btn = document.createElement('button');
                    btn.className = 'category-btn';
                    btn.textContent = cat.label;
                    btn.onclick = () => executeMoveToCategory(cat.name);
                    buttonsContainer.appendChild(btn);
                }
            });

            modal.classList.add('active');
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeMoveModal() {
            const modal = document.getElementById('moveModal');
            modal.classList.remove('active');
        }

        // ì‹¤ì œ ì´ë™ ì‹¤í–‰
        function executeMoveToCategory(targetSheet) {
            closeMoveModal();

            const checkboxes = window.selectedCheckboxes;
            const ids = Array.from(checkboxes).map(cb => cb.dataset.id);

            // ì¦‰ì‹œ UIì—ì„œ ì œê±° (ì†ë„ ê°œì„ )
            ids.forEach(id => {
                const card = document.querySelector(`.card[data-id="${id}"]`);
                if (card) card.remove();
            });

            // ìºì‹œëœ ë°ì´í„° ì—…ë°ì´íŠ¸
            if (cachedData && cachedData[currentSheet]) {
                const movedItems = cachedData[currentSheet].filter(item => ids.includes(String(item.id)));
                cachedData[currentSheet] = cachedData[currentSheet].filter(item => !ids.includes(String(item.id)));

                // ëŒ€ìƒ ì‹œíŠ¸ ìºì‹œ ì´ˆê¸°í™” (ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ìƒì„±)
                if (!cachedData[targetSheet]) {
                    cachedData[targetSheet] = [];
                }

                // ëŒ€ìƒ ì‹œíŠ¸ì— ì¶”ê°€
                cachedData[targetSheet] = [...movedItems, ...cachedData[targetSheet]];
            }

            // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì„œë²„ ë™ê¸°í™”
            const url = `${API_URL}?action=move&ids=${ids.join(',')}&sheetName=${currentSheet}&targetSheet=${targetSheet}`;

            fetch(url)
                .then(res => res.json())
                .then(result => {
                    if (result.status !== 'success') {
                        alert('ì´ë™ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ìƒˆë¡œê³ ì¹¨ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤)');
                    }
                })
                .catch(err => {
                    console.error('ì´ë™ ì˜¤ë¥˜:', err);
                    alert('ì´ë™ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });
        }
    </script>
</body>

</html>